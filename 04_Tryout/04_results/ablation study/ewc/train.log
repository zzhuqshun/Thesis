2025-06-30 13:45:31,915 - ==== Skipping joint LSTM Training Phase ====
2025-06-30 13:45:31,916 - ==== Incremental EWC Training Phase ====
2025-06-30 13:47:01,784 - Base train IDs: ['03', '05', '07', '27']
2025-06-30 13:47:01,819 - Base train size: 92079
2025-06-30 13:47:01,821 - Base val IDs: ['01']
2025-06-30 13:47:01,822 - Base val size: 28612
2025-06-30 13:47:01,823 - Update1 train IDs: ['21', '23', '25']
2025-06-30 13:47:01,824 - Update1 train size: 65674
2025-06-30 13:47:01,825 - Update1 val IDs: ['19']
2025-06-30 13:47:01,826 - Update1 val size: 23120
2025-06-30 13:47:01,827 - Update2 train IDs: ['09', '11', '15', '29']
2025-06-30 13:47:01,828 - Update2 train size: 47891
2025-06-30 13:47:01,830 - Update2 val IDs: ['13']
2025-06-30 13:47:01,831 - Update2 val size: 6445
2025-06-30 13:47:09,201 - Test cell ID: 17
2025-06-30 13:47:09,202 - Test size: 22872
2025-06-30 13:47:09,204 - Test base size: 11139
2025-06-30 13:47:09,205 - Test update1 size: 6312
2025-06-30 13:47:09,206 - Test update2 size: 5421
2025-06-30 13:47:09,246 - [Scaler after fit] center_=[ 3.31975183  0.         27.55116667]
2025-06-30 13:47:09,252 - [Scaler after fit] scale_ =[0.20016217 1.86108033 1.05333333]
2025-06-30 13:47:09,253 - Resampling and scaling complete with RobustScaler
2025-06-30 13:47:11,383 - [task0] Training...
2025-06-30 13:47:11,384 - [task0] EWC active: None (no previous tasks)
2025-06-30 13:47:11,385 - [task0] This task will be stored with λ = 7780.1555769014285 (not used)
2025-06-30 13:47:11,386 - [task0] Training with alpha LWF = 0.00
2025-06-30 13:49:10,282 - Epoch 001 | task 3.8182e-02 | kd 0.0000e+00 | ewc 0.0000e+00 | val 3.7162e-04 | lr 1.00e-04 | 82.65s
2025-06-30 13:50:28,646 - Epoch 002 | task 7.2867e-03 | kd 0.0000e+00 | ewc 0.0000e+00 | val 1.0398e-03 | lr 1.00e-04 | 78.30s
2025-06-30 13:51:46,469 - Epoch 003 | task 5.3097e-03 | kd 0.0000e+00 | ewc 0.0000e+00 | val 3.9763e-04 | lr 1.00e-04 | 77.80s
2025-06-30 13:53:04,244 - Epoch 004 | task 4.3294e-03 | kd 0.0000e+00 | ewc 0.0000e+00 | val 5.3001e-04 | lr 1.00e-04 | 77.70s
2025-06-30 13:54:22,299 - Epoch 005 | task 3.4420e-03 | kd 0.0000e+00 | ewc 0.0000e+00 | val 4.4389e-04 | lr 1.00e-04 | 78.03s
2025-06-30 13:55:40,385 - Epoch 006 | task 2.6740e-03 | kd 0.0000e+00 | ewc 0.0000e+00 | val 4.3592e-04 | lr 1.00e-04 | 78.06s
2025-06-30 13:56:58,891 - Epoch 007 | task 2.0609e-03 | kd 0.0000e+00 | ewc 0.0000e+00 | val 4.5443e-04 | lr 5.00e-05 | 78.47s
2025-06-30 13:58:17,175 - Epoch 008 | task 1.6517e-03 | kd 0.0000e+00 | ewc 0.0000e+00 | val 4.0441e-04 | lr 5.00e-05 | 78.21s
2025-06-30 13:59:36,435 - Epoch 009 | task 1.4034e-03 | kd 0.0000e+00 | ewc 0.0000e+00 | val 4.0720e-04 | lr 5.00e-05 | 79.23s
2025-06-30 14:00:55,417 - Epoch 010 | task 1.1964e-03 | kd 0.0000e+00 | ewc 0.0000e+00 | val 5.0908e-04 | lr 5.00e-05 | 78.93s
2025-06-30 14:02:13,743 - Epoch 011 | task 1.0292e-03 | kd 0.0000e+00 | ewc 0.0000e+00 | val 4.2328e-04 | lr 5.00e-05 | 78.28s
2025-06-30 14:03:32,140 - Epoch 012 | task 8.7673e-04 | kd 0.0000e+00 | ewc 0.0000e+00 | val 4.3260e-04 | lr 5.00e-05 | 78.34s
2025-06-30 14:04:51,485 - Epoch 013 | task 7.6261e-04 | kd 0.0000e+00 | ewc 0.0000e+00 | val 4.6050e-04 | lr 2.50e-05 | 79.31s
2025-06-30 14:06:09,339 - Epoch 014 | task 6.8891e-04 | kd 0.0000e+00 | ewc 0.0000e+00 | val 4.3581e-04 | lr 2.50e-05 | 77.80s
2025-06-30 14:07:28,552 - Epoch 015 | task 6.5224e-04 | kd 0.0000e+00 | ewc 0.0000e+00 | val 4.0288e-04 | lr 2.50e-05 | 79.14s
2025-06-30 14:08:46,550 - Epoch 016 | task 6.1891e-04 | kd 0.0000e+00 | ewc 0.0000e+00 | val 4.0849e-04 | lr 2.50e-05 | 77.97s
2025-06-30 14:10:04,198 - Epoch 017 | task 5.8846e-04 | kd 0.0000e+00 | ewc 0.0000e+00 | val 4.4307e-04 | lr 2.50e-05 | 77.63s
2025-06-30 14:11:22,354 - Epoch 018 | task 5.6076e-04 | kd 0.0000e+00 | ewc 0.0000e+00 | val 4.2150e-04 | lr 2.50e-05 | 78.11s
2025-06-30 14:12:39,804 - Epoch 019 | task 5.3125e-04 | kd 0.0000e+00 | ewc 0.0000e+00 | val 4.3309e-04 | lr 1.25e-05 | 77.36s
2025-06-30 14:13:57,709 - Epoch 020 | task 5.0491e-04 | kd 0.0000e+00 | ewc 0.0000e+00 | val 3.9249e-04 | lr 1.25e-05 | 77.88s
2025-06-30 14:15:15,070 - Epoch 021 | task 4.9213e-04 | kd 0.0000e+00 | ewc 0.0000e+00 | val 3.9523e-04 | lr 1.25e-05 | 77.27s
2025-06-30 14:15:15,581 - Early stopping at epoch 21
2025-06-30 14:15:19,037 - [task0] Training completed.
2025-06-30 14:15:19,039 - [task0] Consolidating EWC...
2025-06-30 14:16:23,322 - [task0] Consolidation done.
2025-06-30 14:16:23,335 - [task0] Baseline evaluation on own task task0 ...
2025-06-30 14:16:28,408 - [task0 Baseline on task0] RMSE: 5.1834e-02, MAE: 4.5294e-02
2025-06-30 14:16:28,409 - [task0] Baseline testing completed.
2025-06-30 14:16:28,410 - [task0] ACC (-MAE): -4.5294e-02
2025-06-30 14:16:28,412 - [task0] Evaluating BEST checkpoint...
2025-06-30 14:16:37,502 - [task0 Evaluation on full test set] RMSE: 8.5567e-02, MAE: 6.7164e-02, R2: -0.0342
2025-06-30 14:16:37,628 - [task0] Evaluation completed.
2025-06-30 14:16:40,064 - [task1] Loading best checkpoint from previous task task0...
2025-06-30 14:16:43,664 - [task1 Pre-FWT baseline] RMSE: 5.6626e-02, MAE: 4.3428e-02
2025-06-30 14:16:43,667 - [task1] Training...
2025-06-30 14:16:43,668 - [task1] EWC active: {"Task 0": 7780.2}
2025-06-30 14:16:43,669 - [task1] This task will be stored with λ = 141.35935551752303
2025-06-30 14:16:43,670 - [task1] Training with alpha LWF = 0.00
2025-06-30 14:17:46,815 - Epoch 001 | task 7.6773e-03 | kd 0.0000e+00 | ewc 2.3650e-01 | val 1.8903e-03 | lr 1.00e-04 | 63.14s
2025-06-30 14:18:45,336 - Epoch 002 | task 4.9382e-03 | kd 0.0000e+00 | ewc 1.3644e-01 | val 1.7071e-03 | lr 1.00e-04 | 58.27s
2025-06-30 14:19:43,529 - Epoch 003 | task 3.3355e-03 | kd 0.0000e+00 | ewc 6.7879e-02 | val 1.4887e-03 | lr 1.00e-04 | 57.96s
2025-06-30 14:20:44,173 - Epoch 004 | task 2.3150e-03 | kd 0.0000e+00 | ewc 2.5819e-02 | val 1.5767e-03 | lr 1.00e-04 | 60.54s
2025-06-30 14:21:42,326 - Epoch 005 | task 2.1279e-03 | kd 0.0000e+00 | ewc 5.8492e-03 | val 1.1188e-03 | lr 1.00e-04 | 58.10s
2025-06-30 14:22:40,430 - Epoch 006 | task 1.6275e-03 | kd 0.0000e+00 | ewc 4.5309e-04 | val 5.1167e-04 | lr 1.00e-04 | 57.93s
2025-06-30 14:23:38,316 - Epoch 007 | task 1.1495e-03 | kd 0.0000e+00 | ewc 4.2393e-05 | val 1.0289e-03 | lr 1.00e-04 | 57.76s
2025-06-30 14:24:36,941 - Epoch 008 | task 1.1433e-03 | kd 0.0000e+00 | ewc 3.6530e-05 | val 1.3103e-03 | lr 1.00e-04 | 58.55s
2025-06-30 14:25:34,262 - Epoch 009 | task 1.0887e-03 | kd 0.0000e+00 | ewc 3.5067e-05 | val 1.6946e-03 | lr 1.00e-04 | 57.29s
2025-06-30 14:26:31,849 - Epoch 010 | task 9.5584e-04 | kd 0.0000e+00 | ewc 3.4769e-05 | val 1.3282e-03 | lr 1.00e-04 | 57.55s
2025-06-30 14:27:29,577 - Epoch 011 | task 9.1198e-04 | kd 0.0000e+00 | ewc 3.5378e-05 | val 1.2641e-03 | lr 1.00e-04 | 57.70s
2025-06-30 14:28:27,651 - Epoch 012 | task 8.8822e-04 | kd 0.0000e+00 | ewc 3.7689e-05 | val 1.4919e-03 | lr 5.00e-05 | 58.04s
2025-06-30 14:29:25,882 - Epoch 013 | task 6.0260e-04 | kd 0.0000e+00 | ewc 3.5359e-05 | val 1.6215e-03 | lr 5.00e-05 | 57.99s
2025-06-30 14:30:23,814 - Epoch 014 | task 5.4361e-04 | kd 0.0000e+00 | ewc 3.3808e-05 | val 1.3147e-03 | lr 5.00e-05 | 57.88s
2025-06-30 14:31:22,094 - Epoch 015 | task 4.9896e-04 | kd 0.0000e+00 | ewc 3.3979e-05 | val 1.7900e-03 | lr 5.00e-05 | 58.25s
2025-06-30 14:32:20,478 - Epoch 016 | task 4.3510e-04 | kd 0.0000e+00 | ewc 3.3225e-05 | val 1.9835e-03 | lr 5.00e-05 | 58.35s
2025-06-30 14:33:18,479 - Epoch 017 | task 4.5510e-04 | kd 0.0000e+00 | ewc 3.2796e-05 | val 2.2671e-03 | lr 5.00e-05 | 57.97s
2025-06-30 14:34:16,120 - Epoch 018 | task 4.1186e-04 | kd 0.0000e+00 | ewc 3.2663e-05 | val 2.3596e-03 | lr 2.50e-05 | 57.61s
2025-06-30 14:35:13,622 - Epoch 019 | task 3.5045e-04 | kd 0.0000e+00 | ewc 3.2374e-05 | val 2.4546e-03 | lr 2.50e-05 | 57.47s
2025-06-30 14:36:11,061 - Epoch 020 | task 3.3389e-04 | kd 0.0000e+00 | ewc 3.1959e-05 | val 2.3237e-03 | lr 2.50e-05 | 57.36s
2025-06-30 14:37:09,111 - Epoch 021 | task 3.1348e-04 | kd 0.0000e+00 | ewc 3.1467e-05 | val 2.5953e-03 | lr 2.50e-05 | 58.02s
2025-06-30 14:38:07,585 - Epoch 022 | task 2.9414e-04 | kd 0.0000e+00 | ewc 3.1134e-05 | val 2.7816e-03 | lr 2.50e-05 | 58.01s
2025-06-30 14:39:05,621 - Epoch 023 | task 2.8176e-04 | kd 0.0000e+00 | ewc 3.0748e-05 | val 2.9608e-03 | lr 2.50e-05 | 58.00s
2025-06-30 14:40:03,534 - Epoch 024 | task 2.9491e-04 | kd 0.0000e+00 | ewc 3.0685e-05 | val 3.1116e-03 | lr 1.25e-05 | 57.88s
2025-06-30 14:41:01,784 - Epoch 025 | task 2.4797e-04 | kd 0.0000e+00 | ewc 3.0249e-05 | val 3.1994e-03 | lr 1.25e-05 | 58.22s
2025-06-30 14:41:59,980 - Epoch 026 | task 2.4692e-04 | kd 0.0000e+00 | ewc 2.9929e-05 | val 2.9892e-03 | lr 1.25e-05 | 58.00s
2025-06-30 14:42:00,050 - Early stopping at epoch 26
2025-06-30 14:42:00,796 - [task1] Training completed.
2025-06-30 14:42:00,798 - [task1] Consolidating EWC...
2025-06-30 14:42:46,293 - [task1] Consolidation done.
2025-06-30 14:42:46,303 - [task1] Baseline evaluation on own task task1 ...
2025-06-30 14:42:49,890 - [task1 Baseline on task1] RMSE: 4.7910e-02, MAE: 4.2695e-02
2025-06-30 14:42:49,892 - [task1] Baseline testing completed.
2025-06-30 14:42:49,895 - [task1] Backward testing on previous task task0...
2025-06-30 14:42:54,927 - [task1 BACKWARD on task0] RMSE: 2.4718e-02, MAE: 2.0868e-02
2025-06-30 14:42:54,929 - [task1] ΔMAE on task0: -2.4427e-02
2025-06-30 14:42:54,930 - [task1] ACC (-MAE): -3.1781e-02
2025-06-30 14:42:54,931 - [task1] BWT: -2.4427e-02
2025-06-30 14:42:54,933 - [task1] FWT: +7.3259e-04
2025-06-30 14:42:54,935 - [task1] Evaluating BEST checkpoint...
2025-06-30 14:43:03,296 - [task1 Evaluation on full test set] RMSE: 6.8451e-02, MAE: 5.1488e-02, R2: 0.3381
2025-06-30 14:43:03,297 - [task1] Evaluation completed.
2025-06-30 14:43:03,299 - [task2] Loading best checkpoint from previous task task1...
2025-06-30 14:43:04,753 - [task2 Pre-FWT baseline] RMSE: 1.2965e-01, MAE: 1.2840e-01
2025-06-30 14:43:04,755 - [task2] Training...
2025-06-30 14:43:04,756 - [task2] EWC active: {"Task 0": 7780.2, "Task 1": 141.36}
2025-06-30 14:43:04,757 - [task2] This task will be stored with λ = 1000
2025-06-30 14:43:04,758 - [task2] Training with alpha LWF = 0.00
2025-06-30 14:43:45,014 - Epoch 001 | task 3.3468e-03 | kd 0.0000e+00 | ewc 8.7751e-05 | val 2.7717e-03 | lr 1.00e-04 | 40.24s
2025-06-30 14:44:25,200 - Epoch 002 | task 1.6900e-03 | kd 0.0000e+00 | ewc 6.9415e-05 | val 1.2220e-03 | lr 1.00e-04 | 40.05s
2025-06-30 14:45:05,747 - Epoch 003 | task 1.4463e-03 | kd 0.0000e+00 | ewc 6.2596e-05 | val 1.6030e-03 | lr 1.00e-04 | 40.38s
2025-06-30 14:45:45,777 - Epoch 004 | task 1.3367e-03 | kd 0.0000e+00 | ewc 5.9408e-05 | val 1.2262e-03 | lr 1.00e-04 | 39.98s
2025-06-30 14:46:26,019 - Epoch 005 | task 1.2019e-03 | kd 0.0000e+00 | ewc 5.8035e-05 | val 8.1395e-04 | lr 1.00e-04 | 40.18s
2025-06-30 14:47:06,682 - Epoch 006 | task 1.1107e-03 | kd 0.0000e+00 | ewc 5.6835e-05 | val 1.3535e-03 | lr 1.00e-04 | 40.49s
2025-06-30 14:47:47,026 - Epoch 007 | task 1.0910e-03 | kd 0.0000e+00 | ewc 5.6208e-05 | val 9.2720e-04 | lr 1.00e-04 | 40.29s
2025-06-30 14:48:27,461 - Epoch 008 | task 9.4919e-04 | kd 0.0000e+00 | ewc 5.6106e-05 | val 1.0511e-03 | lr 1.00e-04 | 40.37s
2025-06-30 14:49:08,420 - Epoch 009 | task 9.4317e-04 | kd 0.0000e+00 | ewc 5.5508e-05 | val 9.6025e-04 | lr 1.00e-04 | 40.78s
2025-06-30 14:49:48,636 - Epoch 010 | task 8.5057e-04 | kd 0.0000e+00 | ewc 5.5124e-05 | val 8.4641e-04 | lr 1.00e-04 | 40.15s
2025-06-30 14:50:28,772 - Epoch 011 | task 7.7447e-04 | kd 0.0000e+00 | ewc 5.4825e-05 | val 1.3250e-03 | lr 5.00e-05 | 40.07s
2025-06-30 14:51:09,336 - Epoch 012 | task 6.7694e-04 | kd 0.0000e+00 | ewc 5.4419e-05 | val 1.2723e-03 | lr 5.00e-05 | 40.52s
2025-06-30 14:51:49,427 - Epoch 013 | task 6.7154e-04 | kd 0.0000e+00 | ewc 5.4075e-05 | val 1.3931e-03 | lr 5.00e-05 | 40.05s
2025-06-30 14:52:29,536 - Epoch 014 | task 6.3808e-04 | kd 0.0000e+00 | ewc 5.3790e-05 | val 1.6832e-03 | lr 5.00e-05 | 40.07s
2025-06-30 14:53:10,507 - Epoch 015 | task 6.2288e-04 | kd 0.0000e+00 | ewc 5.3602e-05 | val 1.4582e-03 | lr 5.00e-05 | 40.92s
2025-06-30 14:53:50,793 - Epoch 016 | task 6.0149e-04 | kd 0.0000e+00 | ewc 5.3405e-05 | val 1.5141e-03 | lr 5.00e-05 | 40.24s
2025-06-30 14:54:30,957 - Epoch 017 | task 5.9280e-04 | kd 0.0000e+00 | ewc 5.3267e-05 | val 1.4256e-03 | lr 2.50e-05 | 40.12s
2025-06-30 14:55:13,777 - Epoch 018 | task 5.3257e-04 | kd 0.0000e+00 | ewc 5.3237e-05 | val 1.3215e-03 | lr 2.50e-05 | 42.78s
2025-06-30 14:55:54,178 - Epoch 019 | task 5.4088e-04 | kd 0.0000e+00 | ewc 5.3083e-05 | val 1.6858e-03 | lr 2.50e-05 | 40.36s
2025-06-30 14:56:34,496 - Epoch 020 | task 5.3528e-04 | kd 0.0000e+00 | ewc 5.2751e-05 | val 1.4439e-03 | lr 2.50e-05 | 40.27s
2025-06-30 14:57:14,500 - Epoch 021 | task 5.3102e-04 | kd 0.0000e+00 | ewc 5.2414e-05 | val 1.7951e-03 | lr 2.50e-05 | 39.96s
2025-06-30 14:57:54,737 - Epoch 022 | task 5.0503e-04 | kd 0.0000e+00 | ewc 5.2854e-05 | val 1.4159e-03 | lr 2.50e-05 | 40.19s
2025-06-30 14:58:34,722 - Epoch 023 | task 5.1007e-04 | kd 0.0000e+00 | ewc 5.2569e-05 | val 1.6693e-03 | lr 1.25e-05 | 39.94s
2025-06-30 14:59:14,826 - Epoch 024 | task 4.7052e-04 | kd 0.0000e+00 | ewc 5.2589e-05 | val 1.3609e-03 | lr 1.25e-05 | 40.06s
2025-06-30 14:59:55,609 - Epoch 025 | task 4.7236e-04 | kd 0.0000e+00 | ewc 5.2594e-05 | val 1.3728e-03 | lr 1.25e-05 | 40.74s
2025-06-30 14:59:55,651 - Early stopping at epoch 25
2025-06-30 14:59:56,506 - [task2] Training completed.
2025-06-30 14:59:56,507 - [task2] Consolidating EWC...
2025-06-30 15:00:29,604 - [task2] Consolidation done.
2025-06-30 15:00:29,606 - [task2] Baseline evaluation on own task task2 ...
2025-06-30 15:00:33,040 - [task2 Baseline on task2] RMSE: 2.2280e-01, MAE: 2.2224e-01
2025-06-30 15:00:33,041 - [task2] Baseline testing completed.
2025-06-30 15:00:33,043 - [task2] Backward testing on previous task task0...
2025-06-30 15:00:37,946 - [task2 BACKWARD on task0] RMSE: 4.3048e-02, MAE: 3.6051e-02
2025-06-30 15:00:37,948 - [task2] Backward testing on previous task task1...
2025-06-30 15:00:41,814 - [task2 BACKWARD on task1] RMSE: 1.2963e-01, MAE: 1.2753e-01
2025-06-30 15:00:41,815 - [task2] ΔMAE on task0: -9.2432e-03
2025-06-30 15:00:41,817 - [task2] ΔMAE on task1: +8.4830e-02
2025-06-30 15:00:41,818 - [task2] ACC (-MAE): -1.2861e-01
2025-06-30 15:00:41,819 - [task2] BWT: +3.7794e-02
2025-06-30 15:00:41,820 - [task2] FWT: -9.3842e-02
2025-06-30 15:00:41,822 - [task2] Evaluating BEST checkpoint...
2025-06-30 15:00:50,449 - [task2 Evaluation on full test set] RMSE: 1.3034e-01, MAE: 1.0505e-01, R2: -1.3996
2025-06-30 15:00:50,452 - [task2] Evaluation completed.
2025-06-30 15:00:50,523 - Saved ACC/BWT/FWT history to /beegfs/home/users/z/zzhuqshun/Thesis/04_NNs/model/ewc_trial2_without_lwf/incremental/continual_metrics.csv
2025-06-30 15:00:51,167 - ==== All tasks completed ====
