2025-07-12 16:02:39,431 - ==== Regular LSTM Training Phase ====
2025-07-12 16:04:47,626 - Base train IDs: ['03', '05', '07', '09', '11', '15', '21', '23', '25', '27', '29']
2025-07-12 16:04:47,627 - Base val IDs: ['01', '19', '13']
2025-07-12 16:04:47,629 - Update1 train IDs: []
2025-07-12 16:04:47,630 - Update1 val IDs: []
2025-07-12 16:04:47,631 - Update2 train IDs: []
2025-07-12 16:04:47,633 - Update2 val IDs: []
2025-07-12 16:04:58,529 - Test cell ID: 17
2025-07-12 16:04:58,637 - [Scaler after fit] center_=[3.34242200e+00 1.79929667e-01 2.77500000e+01 2.02137635e+03]
2025-07-12 16:04:58,672 - [Scaler after fit] scale_ =[1.84283625e-01 1.77955483e+00 1.81783333e+00 2.02598445e+03]
2025-07-12 16:04:58,674 - Feature columns: ['Voltage[V]', 'Current[A]', 'Temperature[Â°C]', 'Q_sum']
2025-07-12 16:04:58,675 - Resampling and scaling complete with RobustScaler
2025-07-12 16:04:58,678 - 
Creating dataset for base_train...
2025-07-12 16:05:22,865 - 
=== Dataset Statistics ===
2025-07-12 16:05:22,875 - Grouping mode: Ungrouped (Cross-Cell)
2025-07-12 16:05:22,876 - Total cells: 11
2025-07-12 16:05:22,877 - Total samples created: 204924
2025-07-12 16:05:22,878 - Sequence length: 720
2025-07-12 16:05:22,879 - 
Cross-cell analysis:
2025-07-12 16:05:22,880 -   Total data points: 205644
2025-07-12 16:05:22,881 -   Cross-cell samples: 7200 (3.5%)
2025-07-12 16:05:22,881 -   Within-cell samples: 197724 (96.5%)
2025-07-12 16:05:22,883 -   Overall efficiency: 99.6% (204924/205644 points used)
2025-07-12 16:05:22,898 - Cell IDs: ['03', '05', '07', '09', '11', '15', '21', '23', '25', '27', '29']
2025-07-12 16:05:22,899 - ==============================
2025-07-12 16:05:22,901 - DataLoader for base_train: 204924 samples, 6404 batches (shuffle=True)
2025-07-12 16:05:22,902 - 
Creating dataset for base_val...
2025-07-12 16:05:29,818 - 
=== Dataset Statistics ===
2025-07-12 16:05:29,819 - Grouping mode: Ungrouped (Cross-Cell)
2025-07-12 16:05:29,820 - Total cells: 3
2025-07-12 16:05:29,821 - Total samples created: 57457
2025-07-12 16:05:29,821 - Sequence length: 720
2025-07-12 16:05:29,822 - 
Cross-cell analysis:
2025-07-12 16:05:29,822 -   Total data points: 58177
2025-07-12 16:05:29,823 -   Cross-cell samples: 1440 (2.5%)
2025-07-12 16:05:29,824 -   Within-cell samples: 56017 (97.5%)
2025-07-12 16:05:29,825 -   Overall efficiency: 98.8% (57457/58177 points used)
2025-07-12 16:05:29,828 - Cell IDs: ['01', '13', '19']
2025-07-12 16:05:29,829 - ==============================
2025-07-12 16:05:29,830 - DataLoader for base_val: 57457 samples, 1796 batches (shuffle=False)
2025-07-12 16:05:29,831 - 
Creating dataset for test_full...
2025-07-12 16:05:32,252 - 
=== Dataset Statistics ===
2025-07-12 16:05:32,253 - Grouping mode: Ungrouped (Cross-Cell)
2025-07-12 16:05:32,254 - Total cells: 1
2025-07-12 16:05:32,255 - Total samples created: 22152
2025-07-12 16:05:32,256 - Sequence length: 720
2025-07-12 16:05:32,257 - 
Cross-cell analysis:
2025-07-12 16:05:32,257 -   Total data points: 22872
2025-07-12 16:05:32,258 -   Cross-cell samples: 0 (0.0%)
2025-07-12 16:05:32,259 -   Within-cell samples: 22152 (100.0%)
2025-07-12 16:05:32,260 -   Overall efficiency: 96.9% (22152/22872 points used)
2025-07-12 16:05:32,262 - Cell IDs: ['17']
2025-07-12 16:05:32,263 - ==============================
2025-07-12 16:05:32,264 - DataLoader for test_full: 22152 samples, 693 batches (shuffle=False)
2025-07-12 16:05:32,265 - 
Creating dataset for test_base...
2025-07-12 16:05:33,400 - 
=== Dataset Statistics ===
2025-07-12 16:05:33,401 - Grouping mode: Ungrouped (Cross-Cell)
2025-07-12 16:05:33,402 - Total cells: 1
2025-07-12 16:05:33,403 - Total samples created: 10419
2025-07-12 16:05:33,405 - Sequence length: 720
2025-07-12 16:05:33,406 - 
Cross-cell analysis:
2025-07-12 16:05:33,407 -   Total data points: 11139
2025-07-12 16:05:33,409 -   Cross-cell samples: 0 (0.0%)
2025-07-12 16:05:33,410 -   Within-cell samples: 10419 (100.0%)
2025-07-12 16:05:33,411 -   Overall efficiency: 93.5% (10419/11139 points used)
2025-07-12 16:05:33,412 - Cell IDs: ['17']
2025-07-12 16:05:33,414 - ==============================
2025-07-12 16:05:33,415 - DataLoader for test_base: 10419 samples, 326 batches (shuffle=False)
2025-07-12 16:05:33,416 - 
Creating dataset for test_update1...
2025-07-12 16:05:34,030 - 
=== Dataset Statistics ===
2025-07-12 16:05:34,031 - Grouping mode: Ungrouped (Cross-Cell)
2025-07-12 16:05:34,032 - Total cells: 1
2025-07-12 16:05:34,033 - Total samples created: 5592
2025-07-12 16:05:34,034 - Sequence length: 720
2025-07-12 16:05:34,035 - 
Cross-cell analysis:
2025-07-12 16:05:34,036 -   Total data points: 6312
2025-07-12 16:05:34,037 -   Cross-cell samples: 0 (0.0%)
2025-07-12 16:05:34,038 -   Within-cell samples: 5592 (100.0%)
2025-07-12 16:05:34,039 -   Overall efficiency: 88.6% (5592/6312 points used)
2025-07-12 16:05:34,041 - Cell IDs: ['17']
2025-07-12 16:05:34,042 - ==============================
2025-07-12 16:05:34,044 - DataLoader for test_update1: 5592 samples, 175 batches (shuffle=False)
2025-07-12 16:05:34,045 - 
Creating dataset for test_update2...
2025-07-12 16:05:34,566 - 
=== Dataset Statistics ===
2025-07-12 16:05:34,567 - Grouping mode: Ungrouped (Cross-Cell)
2025-07-12 16:05:34,568 - Total cells: 1
2025-07-12 16:05:34,569 - Total samples created: 4701
2025-07-12 16:05:34,570 - Sequence length: 720
2025-07-12 16:05:34,571 - 
Cross-cell analysis:
2025-07-12 16:05:34,572 -   Total data points: 5421
2025-07-12 16:05:34,572 -   Cross-cell samples: 0 (0.0%)
2025-07-12 16:05:34,573 -   Within-cell samples: 4701 (100.0%)
2025-07-12 16:05:34,574 -   Overall efficiency: 86.7% (4701/5421 points used)
2025-07-12 16:05:34,575 - Cell IDs: ['17']
2025-07-12 16:05:34,577 - ==============================
2025-07-12 16:05:34,578 - DataLoader for test_update2: 4701 samples, 147 batches (shuffle=False)
2025-07-12 16:09:22,522 - Epoch 001 | task 1.8154e-02 | kd 0.0000e+00 | ewc 0.0000e+00 | val 3.8449e-03 | lr 1.00e-04 | 189.21s
2025-07-12 16:13:14,617 - Epoch 002 | task 5.1222e-03 | kd 0.0000e+00 | ewc 0.0000e+00 | val 2.6632e-03 | lr 1.00e-04 | 231.98s
2025-07-12 16:17:44,658 - Epoch 003 | task 3.0531e-03 | kd 0.0000e+00 | ewc 0.0000e+00 | val 2.0753e-03 | lr 1.00e-04 | 269.79s
2025-07-12 16:21:54,160 - Epoch 004 | task 1.6327e-03 | kd 0.0000e+00 | ewc 0.0000e+00 | val 3.0677e-03 | lr 1.00e-04 | 249.23s
2025-07-12 16:25:52,113 - Epoch 005 | task 8.5076e-04 | kd 0.0000e+00 | ewc 0.0000e+00 | val 2.9247e-03 | lr 1.00e-04 | 237.79s
2025-07-12 16:29:46,967 - Epoch 006 | task 5.5153e-04 | kd 0.0000e+00 | ewc 0.0000e+00 | val 3.0455e-03 | lr 1.00e-04 | 234.70s
2025-07-12 16:33:44,341 - Epoch 007 | task 4.4317e-04 | kd 0.0000e+00 | ewc 0.0000e+00 | val 3.2448e-03 | lr 1.00e-04 | 237.23s
2025-07-12 16:37:40,582 - Epoch 008 | task 3.0748e-04 | kd 0.0000e+00 | ewc 0.0000e+00 | val 1.4990e-03 | lr 1.00e-04 | 236.09s
2025-07-12 16:41:42,523 - Epoch 009 | task 2.7330e-04 | kd 0.0000e+00 | ewc 0.0000e+00 | val 2.5622e-03 | lr 1.00e-04 | 241.73s
2025-07-12 16:44:52,702 - Epoch 010 | task 2.6434e-04 | kd 0.0000e+00 | ewc 0.0000e+00 | val 2.4660e-03 | lr 1.00e-04 | 190.01s
2025-07-12 16:48:00,831 - Epoch 011 | task 2.1752e-04 | kd 0.0000e+00 | ewc 0.0000e+00 | val 2.5509e-03 | lr 1.00e-04 | 188.03s
2025-07-12 16:51:06,465 - Epoch 012 | task 2.1144e-04 | kd 0.0000e+00 | ewc 0.0000e+00 | val 2.5238e-03 | lr 1.00e-04 | 185.54s
2025-07-12 16:54:14,144 - Epoch 013 | task 1.8557e-04 | kd 0.0000e+00 | ewc 0.0000e+00 | val 2.3564e-03 | lr 1.00e-04 | 187.59s
2025-07-12 16:57:21,502 - Epoch 014 | task 1.9334e-04 | kd 0.0000e+00 | ewc 0.0000e+00 | val 2.5020e-03 | lr 5.00e-05 | 187.27s
2025-07-12 17:00:26,525 - Epoch 015 | task 1.4863e-04 | kd 0.0000e+00 | ewc 0.0000e+00 | val 2.5118e-03 | lr 5.00e-05 | 184.95s
2025-07-12 17:03:33,798 - Epoch 016 | task 1.4311e-04 | kd 0.0000e+00 | ewc 0.0000e+00 | val 2.7984e-03 | lr 5.00e-05 | 187.18s
2025-07-12 17:06:37,444 - Epoch 017 | task 1.3892e-04 | kd 0.0000e+00 | ewc 0.0000e+00 | val 2.0575e-03 | lr 5.00e-05 | 183.53s
2025-07-12 17:09:45,163 - Epoch 018 | task 1.4006e-04 | kd 0.0000e+00 | ewc 0.0000e+00 | val 2.2425e-03 | lr 5.00e-05 | 187.62s
2025-07-12 17:14:27,972 - Epoch 019 | task 1.3361e-04 | kd 0.0000e+00 | ewc 0.0000e+00 | val 3.3260e-03 | lr 5.00e-05 | 282.63s
2025-07-12 17:19:11,200 - Epoch 020 | task 1.3408e-04 | kd 0.0000e+00 | ewc 0.0000e+00 | val 2.9954e-03 | lr 2.50e-05 | 283.00s
2025-07-12 17:23:09,616 - Epoch 021 | task 1.2301e-04 | kd 0.0000e+00 | ewc 0.0000e+00 | val 2.6462e-03 | lr 2.50e-05 | 238.19s
2025-07-12 17:27:00,841 - Epoch 022 | task 1.2291e-04 | kd 0.0000e+00 | ewc 0.0000e+00 | val 2.6153e-03 | lr 2.50e-05 | 231.10s
2025-07-12 17:30:15,632 - Epoch 023 | task 1.2069e-04 | kd 0.0000e+00 | ewc 0.0000e+00 | val 2.5222e-03 | lr 2.50e-05 | 194.67s
2025-07-12 17:33:20,324 - Epoch 024 | task 1.2101e-04 | kd 0.0000e+00 | ewc 0.0000e+00 | val 2.4197e-03 | lr 2.50e-05 | 184.55s
2025-07-12 17:36:26,032 - Epoch 025 | task 1.2012e-04 | kd 0.0000e+00 | ewc 0.0000e+00 | val 2.6160e-03 | lr 2.50e-05 | 185.60s
2025-07-12 17:39:30,494 - Epoch 026 | task 1.2006e-04 | kd 0.0000e+00 | ewc 0.0000e+00 | val 2.8072e-03 | lr 1.25e-05 | 184.37s
2025-07-12 17:42:37,302 - Epoch 027 | task 1.1641e-04 | kd 0.0000e+00 | ewc 0.0000e+00 | val 2.6092e-03 | lr 1.25e-05 | 186.68s
2025-07-12 17:45:44,318 - Epoch 028 | task 1.1366e-04 | kd 0.0000e+00 | ewc 0.0000e+00 | val 2.5785e-03 | lr 1.25e-05 | 186.89s
2025-07-12 17:45:44,685 - Early stopping at epoch 28
2025-07-12 17:45:58,518 - [Joint training best model predictions] RMSE: 3.6687e-02, MAE: 2.2148e-02, R2: 0.8099
