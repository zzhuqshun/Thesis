2025-08-14 16:10:26,806 - INFO - ==== Incremental Training (SI + KD via SITrainer) ====
2025-08-14 16:10:26,828 - INFO - Number of tasks: 3
2025-08-14 16:12:03,143 - INFO - Incremental training - Task 0 Train IDs: ['03', '27', '05', '21', '11'], size: 107395
2025-08-14 16:12:03,167 - INFO - Incremental training - Task 0 Val IDs: ['01'], size: 20028
2025-08-14 16:12:03,174 - INFO - Incremental training - Test Task 0 size: 8584
2025-08-14 16:12:03,179 - INFO - Incremental training - Task 1 Train IDs: ['09', '29', '25'], size: 41175
2025-08-14 16:12:03,183 - INFO - Incremental training - Task 1 Val IDs: ['19'], size: 16183
2025-08-14 16:12:03,189 - INFO - Incremental training - Test Task 1 size: 6937
2025-08-14 16:12:03,194 - INFO - Incremental training - Task 2 Train IDs: ['15', '07', '23'], size: 57074
2025-08-14 16:12:03,201 - INFO - Incremental training - Task 2 Val IDs: ['13'], size: 4511
2025-08-14 16:12:03,209 - INFO - Incremental training - Test Task 2 size: 1934
2025-08-14 16:12:03,261 - INFO -   (Scaler) Scaler centers: [ 3.3374245   0.101279   27.50083333]
2025-08-14 16:12:03,272 - INFO -   (Scaler) Scaler scales: [0.18253608 1.77971742 1.05683333]
2025-08-14 16:19:51,057 - INFO - ========== Model Structure ==========
2025-08-14 16:19:51,073 - INFO - 
SOHLSTM(
  (lstm): LSTM(3, 128, num_layers=2, batch_first=True, dropout=0.3)
  (fc): Sequential(
    (0): Linear(in_features=128, out_features=64, bias=True)
    (1): LeakyReLU(negative_slope=0.01)
    (2): Dropout(p=0.3, inplace=False)
    (3): Linear(in_features=64, out_features=1, bias=True)
  )
)
2025-08-14 16:19:51,080 - INFO - =====================================
2025-08-14 16:19:51,092 - INFO - ====== Model Parameters Details ======
2025-08-14 16:19:51,107 - INFO - lstm.weight_ih_l0                                  | trainable |     1536 params
2025-08-14 16:19:51,118 - INFO - lstm.weight_hh_l0                                  | trainable |    65536 params
2025-08-14 16:19:51,134 - INFO - lstm.bias_ih_l0                                    | trainable |      512 params
2025-08-14 16:19:51,149 - INFO - lstm.bias_hh_l0                                    | trainable |      512 params
2025-08-14 16:19:51,164 - INFO - lstm.weight_ih_l1                                  | trainable |    65536 params
2025-08-14 16:19:51,179 - INFO - lstm.weight_hh_l1                                  | trainable |    65536 params
2025-08-14 16:19:51,192 - INFO - lstm.bias_ih_l1                                    | trainable |      512 params
2025-08-14 16:19:51,205 - INFO - lstm.bias_hh_l1                                    | trainable |      512 params
2025-08-14 16:19:51,215 - INFO - fc.0.weight                                        | trainable |     8192 params
2025-08-14 16:19:51,229 - INFO - fc.0.bias                                          | trainable |       64 params
2025-08-14 16:19:51,239 - INFO - fc.3.weight                                        | trainable |       64 params
2025-08-14 16:19:51,250 - INFO - fc.3.bias                                          | trainable |        1 params
2025-08-14 16:19:51,259 - INFO - --------------------------------------------------------------------------------
2025-08-14 16:19:51,276 - INFO - Total params:                                          208513 params (only trainable)
2025-08-14 16:19:51,285 - INFO - =====================================
2025-08-14 16:19:51,693 - INFO - === Train task 0 in mode: SI+KD ===
2025-08-14 16:23:12,505 - INFO - Epoch 0: task=3.4180e-02 kd%=0.00% si%=0.00% kl=0.000 val_mse=1.8106e-03 lr=1.00000e-04
2025-08-14 16:26:27,144 - INFO - Epoch 1: task=7.4519e-03 kd%=0.00% si%=0.00% kl=0.000 val_mse=9.6827e-04 lr=1.00000e-04
2025-08-14 16:29:45,877 - INFO - Epoch 2: task=5.6411e-03 kd%=0.00% si%=0.00% kl=0.000 val_mse=1.1449e-03 lr=1.00000e-04
2025-08-14 16:33:12,748 - INFO - Epoch 3: task=4.6387e-03 kd%=0.00% si%=0.00% kl=0.000 val_mse=5.0094e-04 lr=1.00000e-04
2025-08-14 16:36:33,014 - INFO - Epoch 4: task=3.7086e-03 kd%=0.00% si%=0.00% kl=0.000 val_mse=1.0208e-03 lr=1.00000e-04
2025-08-14 16:40:01,537 - INFO - Epoch 5: task=2.8452e-03 kd%=0.00% si%=0.00% kl=0.000 val_mse=3.8385e-04 lr=1.00000e-04
2025-08-14 16:42:42,330 - INFO - Epoch 6: task=1.9421e-03 kd%=0.00% si%=0.00% kl=0.000 val_mse=3.4660e-04 lr=1.00000e-04
2025-08-14 16:45:22,917 - INFO - Epoch 7: task=1.3745e-03 kd%=0.00% si%=0.00% kl=0.000 val_mse=2.3536e-04 lr=1.00000e-04
2025-08-14 16:48:09,284 - INFO - Epoch 8: task=1.1364e-03 kd%=0.00% si%=0.00% kl=0.000 val_mse=2.8731e-04 lr=1.00000e-04
2025-08-14 16:50:57,112 - INFO - Epoch 9: task=8.5870e-04 kd%=0.00% si%=0.00% kl=0.000 val_mse=9.2570e-04 lr=1.00000e-04
2025-08-14 16:53:49,111 - INFO - Epoch 10: task=6.4581e-04 kd%=0.00% si%=0.00% kl=0.000 val_mse=9.1032e-04 lr=1.00000e-04
2025-08-14 16:56:40,279 - INFO - Epoch 11: task=5.3212e-04 kd%=0.00% si%=0.00% kl=0.000 val_mse=1.2565e-03 lr=1.00000e-04
2025-08-14 16:59:32,781 - INFO - Epoch 12: task=4.7212e-04 kd%=0.00% si%=0.00% kl=0.000 val_mse=8.5282e-03 lr=1.00000e-04
2025-08-14 17:02:26,684 - INFO - Epoch 13: task=4.5203e-04 kd%=0.00% si%=0.00% kl=0.000 val_mse=2.6870e-03 lr=5.00000e-05
2025-08-14 17:06:10,331 - INFO - Epoch 14: task=3.1623e-04 kd%=0.00% si%=0.00% kl=0.000 val_mse=1.1495e-02 lr=5.00000e-05
2025-08-14 17:10:07,995 - INFO - Epoch 15: task=2.0441e-04 kd%=0.00% si%=0.00% kl=0.000 val_mse=1.1450e-02 lr=5.00000e-05
2025-08-14 17:13:38,156 - INFO - Epoch 16: task=2.8459e-04 kd%=0.00% si%=0.00% kl=0.000 val_mse=5.0561e-03 lr=5.00000e-05
2025-08-14 17:16:43,088 - INFO - Epoch 17: task=4.2233e-04 kd%=0.00% si%=0.00% kl=0.000 val_mse=7.1749e-03 lr=5.00000e-05
2025-08-14 17:19:34,405 - INFO - Epoch 18: task=2.4177e-04 kd%=0.00% si%=0.00% kl=0.000 val_mse=7.7412e-03 lr=5.00000e-05
2025-08-14 17:21:26,618 - INFO - Epoch 19: task=1.7373e-04 kd%=0.00% si%=0.00% kl=0.000 val_mse=8.2510e-03 lr=2.50000e-05
2025-08-14 17:23:21,596 - INFO - Epoch 20: task=1.1911e-04 kd%=0.00% si%=0.00% kl=0.000 val_mse=7.0348e-03 lr=2.50000e-05
2025-08-14 17:25:11,275 - INFO - Epoch 21: task=1.0880e-04 kd%=0.00% si%=0.00% kl=0.000 val_mse=4.9684e-03 lr=2.50000e-05
2025-08-14 17:27:06,718 - INFO - Epoch 22: task=9.9817e-05 kd%=0.00% si%=0.00% kl=0.000 val_mse=5.4105e-03 lr=2.50000e-05
2025-08-14 17:29:33,264 - INFO - Epoch 23: task=9.6722e-05 kd%=0.00% si%=0.00% kl=0.000 val_mse=4.8673e-03 lr=2.50000e-05
2025-08-14 17:32:00,031 - INFO - Epoch 24: task=9.0512e-05 kd%=0.00% si%=0.00% kl=0.000 val_mse=4.2275e-03 lr=2.50000e-05
2025-08-14 17:34:15,571 - INFO - Epoch 25: task=8.6462e-05 kd%=0.00% si%=0.00% kl=0.000 val_mse=8.7125e-03 lr=1.25000e-05
2025-08-14 17:36:40,376 - INFO - Epoch 26: task=8.0015e-05 kd%=0.00% si%=0.00% kl=0.000 val_mse=4.1118e-03 lr=1.25000e-05
2025-08-14 17:39:10,917 - INFO - Epoch 27: task=7.8002e-05 kd%=0.00% si%=0.00% kl=0.000 val_mse=4.4624e-03 lr=1.25000e-05
2025-08-14 17:39:10,939 - INFO - Early stopping at epoch 27
2025-08-14 17:39:10,948 - INFO - Task 0 finished. Restored ValBest weights (val_mse=2.353589e-04).
2025-08-14 17:39:11,458 - INFO - Saved best checkpoint: /beegfs/home/users/z/zzhuqshun/Thesis/final/inc_no_ema/task0/task0_best.pt
2025-08-14 17:39:22,039 - INFO - === Train task 1 in mode: SI+KD ===
2025-08-14 17:40:28,884 - INFO - Epoch 0: task=2.0700e-03 kd%=5.65% si%=2.95% kl=0.750 val_mse=4.5629e-04 lr=1.25000e-05
2025-08-14 17:41:31,418 - INFO - Epoch 1: task=1.7740e-03 kd%=11.31% si%=5.89% kl=0.750 val_mse=6.1746e-04 lr=1.25000e-05
2025-08-14 17:42:28,049 - INFO - Epoch 2: task=1.7562e-03 kd%=16.94% si%=8.86% kl=0.749 val_mse=8.1659e-04 lr=1.25000e-05
2025-08-14 17:43:25,383 - INFO - Epoch 3: task=1.7667e-03 kd%=22.62% si%=11.78% kl=0.751 val_mse=5.8277e-04 lr=6.25000e-06
2025-08-14 17:44:25,141 - INFO - Epoch 4: task=1.7342e-03 kd%=28.23% si%=14.77% kl=0.749 val_mse=6.1428e-04 lr=6.25000e-06
2025-08-14 17:45:24,851 - INFO - Epoch 5: task=1.7335e-03 kd%=28.18% si%=14.82% kl=0.747 val_mse=6.4949e-04 lr=6.25000e-06
2025-08-14 17:46:18,716 - INFO - Epoch 6: task=1.7226e-03 kd%=28.36% si%=14.64% kl=0.754 val_mse=6.4554e-04 lr=6.25000e-06
2025-08-14 17:47:13,447 - INFO - Epoch 7: task=1.7471e-03 kd%=28.29% si%=14.71% kl=0.752 val_mse=6.9162e-04 lr=6.25000e-06
2025-08-14 17:48:08,369 - INFO - Epoch 8: task=1.7475e-03 kd%=28.21% si%=14.79% kl=0.749 val_mse=5.7781e-04 lr=6.25000e-06
2025-08-14 17:49:03,088 - INFO - Epoch 9: task=1.7651e-03 kd%=28.28% si%=14.72% kl=0.751 val_mse=5.7852e-04 lr=3.12500e-06
2025-08-14 17:49:57,841 - INFO - Epoch 10: task=1.7291e-03 kd%=28.27% si%=14.73% kl=0.751 val_mse=6.3051e-04 lr=3.12500e-06
2025-08-14 17:50:52,565 - INFO - Epoch 11: task=1.7306e-03 kd%=28.27% si%=14.73% kl=0.751 val_mse=6.6134e-04 lr=3.12500e-06
2025-08-14 17:51:47,261 - INFO - Epoch 12: task=1.7147e-03 kd%=28.18% si%=14.82% kl=0.747 val_mse=7.4719e-04 lr=3.12500e-06
2025-08-14 17:52:41,918 - INFO - Epoch 13: task=1.7087e-03 kd%=28.27% si%=14.73% kl=0.751 val_mse=7.5994e-04 lr=3.12500e-06
2025-08-14 17:53:36,525 - INFO - Epoch 14: task=1.7213e-03 kd%=28.31% si%=14.69% kl=0.752 val_mse=6.7859e-04 lr=3.12500e-06
2025-08-14 17:54:31,229 - INFO - Epoch 15: task=1.7168e-03 kd%=28.28% si%=14.72% kl=0.751 val_mse=6.8324e-04 lr=1.56250e-06
2025-08-14 17:55:26,013 - INFO - Epoch 16: task=1.6875e-03 kd%=28.27% si%=14.73% kl=0.751 val_mse=6.6009e-04 lr=1.56250e-06
2025-08-14 17:56:20,890 - INFO - Epoch 17: task=1.6857e-03 kd%=28.19% si%=14.81% kl=0.748 val_mse=6.4977e-04 lr=1.56250e-06
2025-08-14 17:57:15,129 - INFO - Epoch 18: task=1.6954e-03 kd%=28.22% si%=14.78% kl=0.749 val_mse=6.6217e-04 lr=1.56250e-06
2025-08-14 17:58:09,312 - INFO - Epoch 19: task=1.6865e-03 kd%=28.27% si%=14.73% kl=0.751 val_mse=6.6934e-04 lr=1.56250e-06
2025-08-14 17:59:03,140 - INFO - Epoch 20: task=1.7178e-03 kd%=28.25% si%=14.75% kl=0.750 val_mse=6.2882e-04 lr=1.56250e-06
2025-08-14 17:59:03,157 - INFO - Early stopping at epoch 20
2025-08-14 17:59:03,158 - INFO - Task 1 finished. Restored ValBest weights (val_mse=4.562927e-04).
2025-08-14 17:59:03,207 - INFO - Saved best checkpoint: /beegfs/home/users/z/zzhuqshun/Thesis/final/inc_no_ema/task1/task1_best.pt
2025-08-14 17:59:06,651 - INFO - === Train task 2 in mode: SI+KD ===
2025-08-14 18:00:16,231 - INFO - Epoch 0: task=4.4009e-03 kd%=3.78% si%=4.24% kl=0.404 val_mse=1.2108e-02 lr=1.00000e-06
2025-08-14 18:01:25,943 - INFO - Epoch 1: task=2.9165e-03 kd%=7.57% si%=9.63% kl=0.404 val_mse=6.2178e-03 lr=1.00000e-06
2025-08-14 18:02:35,451 - INFO - Epoch 2: task=2.6850e-03 kd%=11.31% si%=14.49% kl=0.402 val_mse=6.2418e-03 lr=1.00000e-06
2025-08-14 18:03:45,011 - INFO - Epoch 3: task=3.0382e-03 kd%=15.12% si%=19.28% kl=0.404 val_mse=1.2555e-02 lr=1.00000e-06
2025-08-14 18:04:54,528 - INFO - Epoch 4: task=4.5331e-03 kd%=18.91% si%=11.57% kl=0.404 val_mse=3.4002e-02 lr=1.00000e-06
2025-08-14 18:06:04,306 - INFO - Epoch 5: task=4.8889e-03 kd%=18.91% si%=4.76% kl=0.404 val_mse=3.5091e-02 lr=1.00000e-06
2025-08-14 18:07:13,768 - INFO - Epoch 6: task=4.8839e-03 kd%=19.07% si%=4.54% kl=0.410 val_mse=3.4902e-02 lr=1.00000e-06
2025-08-14 18:08:23,380 - INFO - Epoch 7: task=4.9067e-03 kd%=18.85% si%=4.54% kl=0.402 val_mse=3.4698e-02 lr=1.00000e-06
2025-08-14 18:09:33,372 - INFO - Epoch 8: task=4.8906e-03 kd%=19.05% si%=4.43% kl=0.409 val_mse=3.4860e-02 lr=1.00000e-06
2025-08-14 18:10:43,332 - INFO - Epoch 9: task=4.8922e-03 kd%=18.99% si%=4.66% kl=0.407 val_mse=3.5121e-02 lr=1.00000e-06
2025-08-14 18:11:55,406 - INFO - Epoch 10: task=4.8750e-03 kd%=18.98% si%=4.60% kl=0.407 val_mse=3.5204e-02 lr=1.00000e-06
2025-08-14 18:13:07,407 - INFO - Epoch 11: task=4.8752e-03 kd%=18.87% si%=4.61% kl=0.403 val_mse=3.4681e-02 lr=1.00000e-06
2025-08-14 18:14:19,442 - INFO - Epoch 12: task=4.8997e-03 kd%=18.90% si%=4.48% kl=0.404 val_mse=3.4438e-02 lr=1.00000e-06
2025-08-14 18:15:31,378 - INFO - Epoch 13: task=4.8806e-03 kd%=18.96% si%=4.38% kl=0.406 val_mse=3.4753e-02 lr=1.00000e-06
2025-08-14 18:16:43,366 - INFO - Epoch 14: task=4.8770e-03 kd%=18.82% si%=4.47% kl=0.401 val_mse=3.4188e-02 lr=1.00000e-06
2025-08-14 18:17:55,199 - INFO - Epoch 15: task=4.8791e-03 kd%=18.97% si%=4.49% kl=0.406 val_mse=3.4535e-02 lr=1.00000e-06
2025-08-14 18:19:07,458 - INFO - Epoch 16: task=4.8803e-03 kd%=18.86% si%=4.53% kl=0.402 val_mse=3.5340e-02 lr=1.00000e-06
2025-08-14 18:20:19,764 - INFO - Epoch 17: task=4.8892e-03 kd%=18.96% si%=4.47% kl=0.406 val_mse=3.5026e-02 lr=1.00000e-06
2025-08-14 18:21:32,149 - INFO - Epoch 18: task=4.8797e-03 kd%=19.05% si%=4.63% kl=0.409 val_mse=3.4203e-02 lr=1.00000e-06
2025-08-14 18:22:44,399 - INFO - Epoch 19: task=4.8644e-03 kd%=18.95% si%=4.55% kl=0.406 val_mse=3.5128e-02 lr=1.00000e-06
2025-08-14 18:23:56,872 - INFO - Epoch 20: task=4.8705e-03 kd%=18.93% si%=4.43% kl=0.405 val_mse=3.4556e-02 lr=1.00000e-06
2025-08-14 18:25:09,267 - INFO - Epoch 21: task=4.8730e-03 kd%=18.90% si%=4.50% kl=0.404 val_mse=3.4493e-02 lr=1.00000e-06
2025-08-14 18:25:09,269 - INFO - Early stopping at epoch 21
2025-08-14 18:25:09,271 - INFO - Task 2 finished. Restored ValBest weights (val_mse=6.217848e-03).
2025-08-14 18:25:09,385 - INFO - Saved best checkpoint: /beegfs/home/users/z/zzhuqshun/Thesis/final/inc_no_ema/task2/task2_best.pt
2025-08-14 18:25:11,862 - INFO - ==== Incremental Training Complete ====
2025-08-14 18:25:11,863 - INFO - Evaluating final model...
2025-08-14 18:25:11,864 - INFO - ==== Starting Comprehensive Evaluation ====
2025-08-14 18:25:11,883 - INFO - Evaluating model trained after task 0...
2025-08-14 18:25:18,603 - INFO - Full test set evaluation: MAE=5.6224e-02, R2=0.1693
2025-08-14 18:25:24,384 - INFO -   Task 0 -> Test Task 0: MAE=2.7923e-02, R2=-29.2707
2025-08-14 18:25:26,218 - INFO -   Task 0 -> Test Task 1: MAE=3.5453e-02, R2=-2.1284
2025-08-14 18:25:26,581 - INFO -   Task 0 -> Test Task 2: MAE=7.2164e-01, R2=-980.0900
2025-08-14 18:25:26,583 - INFO - Evaluating model trained after task 1...
2025-08-14 18:25:33,187 - INFO - Full test set evaluation: MAE=4.7196e-02, R2=0.4763
2025-08-14 18:25:38,949 - INFO -   Task 1 -> Test Task 0: MAE=1.6651e-02, R2=-24.4271
2025-08-14 18:25:40,782 - INFO -   Task 1 -> Test Task 1: MAE=4.6738e-02, R2=-4.2268
2025-08-14 18:25:41,145 - INFO -   Task 1 -> Test Task 2: MAE=5.1203e-02, R2=-3.9429
2025-08-14 18:25:41,147 - INFO - Evaluating model trained after task 2...
2025-08-14 18:25:47,699 - INFO - Full test set evaluation: MAE=5.8855e-02, R2=0.2053
2025-08-14 18:25:53,452 - INFO -   Task 2 -> Test Task 0: MAE=5.4183e-03, R2=-1.7276
2025-08-14 18:25:55,284 - INFO -   Task 2 -> Test Task 1: MAE=4.7950e-02, R2=-4.2160
2025-08-14 18:25:55,647 - INFO -   Task 2 -> Test Task 2: MAE=1.0175e-01, R2=-13.6437
2025-08-14 18:25:55,648 - INFO - ==== Computing Continual Learning Metrics ====
2025-08-14 18:25:55,650 - INFO - Computing random initialization baselines...
2025-08-14 18:25:58,022 - INFO -   Baseline Task 0: R=-0.9732
2025-08-14 18:25:59,839 - INFO -   Baseline Task 1: R=-0.9253
2025-08-14 18:26:00,197 - INFO -   Baseline Task 2: R=-0.6923
2025-08-14 18:26:00,199 - INFO - ==== Continual Learning Results ====
2025-08-14 18:26:00,200 - INFO - BWT (Backward Transfer): 0.0106 (positive = backward gain)
2025-08-14 18:26:00,202 - INFO - FWT (Forward Transfer): 0.7654 (positive = beneficial transfer)
2025-08-14 18:26:00,203 - INFO - ACC (Average Accuracy): -0.0517
2025-08-14 18:26:00,204 - INFO - ==== Performance Matrix R[i][j] ====
2025-08-14 18:26:00,206 - INFO - Rows: trained after task i, Columns: evaluated on task j
2025-08-14 18:26:00,207 - INFO -        Task 0 Task 1 Task 2
2025-08-14 18:26:00,208 - INFO - Task 0: -0.0279 -0.0355 -0.7216
2025-08-14 18:26:00,209 - INFO - Task 1: -0.0167 -0.0467 -0.0512
2025-08-14 18:26:00,211 - INFO - Task 2: -0.0054 -0.0480 -0.1017
2025-08-14 18:26:00,295 - INFO - ==== Evaluation Complete ====
2025-08-14 18:26:00,297 - INFO - All results saved to: /beegfs/home/users/z/zzhuqshun/Thesis/final/inc_no_ema/metrics
