2025-08-12 22:27:36,600 - INFO - ==== Starting Joint Training ====
2025-08-12 22:29:14,304 - INFO - Joint training - Train IDs: ['03', '05', '07', '09', '11', '15', '21', '23', '25', '27', '29'], size: 205644
2025-08-12 22:29:14,312 - INFO - Joint training - Val IDs: ['01', '19', '13'], size: 58177
2025-08-12 22:29:14,318 - INFO - Joint training - Test ID: 17, size: 22872
2025-08-12 22:29:14,345 - INFO -   (Scaler) Scaler centers: [ 3.342422    0.17992967 27.75      ]
2025-08-12 22:29:14,357 - INFO -   (Scaler) Scaler scales: [0.18428363 1.77955483 1.81783333]
2025-08-12 22:29:15,833 - INFO - ========== Model Structure ==========
2025-08-12 22:29:15,843 - INFO - 
SOHLSTM(
  (lstm): LSTM(3, 128, num_layers=2, batch_first=True, dropout=0.3)
  (fc): Sequential(
    (0): Linear(in_features=128, out_features=64, bias=True)
    (1): LeakyReLU(negative_slope=0.01)
    (2): Dropout(p=0.3, inplace=False)
    (3): Linear(in_features=64, out_features=1, bias=True)
  )
)
2025-08-12 22:29:15,854 - INFO - =====================================
2025-08-12 22:29:15,862 - INFO - ====== Model Parameters Details ======
2025-08-12 22:29:15,869 - INFO - lstm.weight_ih_l0                                  | trainable |     1536 params
2025-08-12 22:29:15,877 - INFO - lstm.weight_hh_l0                                  | trainable |    65536 params
2025-08-12 22:29:15,884 - INFO - lstm.bias_ih_l0                                    | trainable |      512 params
2025-08-12 22:29:15,892 - INFO - lstm.bias_hh_l0                                    | trainable |      512 params
2025-08-12 22:29:15,900 - INFO - lstm.weight_ih_l1                                  | trainable |    65536 params
2025-08-12 22:29:15,909 - INFO - lstm.weight_hh_l1                                  | trainable |    65536 params
2025-08-12 22:29:15,916 - INFO - lstm.bias_ih_l1                                    | trainable |      512 params
2025-08-12 22:29:15,925 - INFO - lstm.bias_hh_l1                                    | trainable |      512 params
2025-08-12 22:29:15,934 - INFO - fc.0.weight                                        | trainable |     8192 params
2025-08-12 22:29:15,940 - INFO - fc.0.bias                                          | trainable |       64 params
2025-08-12 22:29:15,948 - INFO - fc.3.weight                                        | trainable |       64 params
2025-08-12 22:29:15,958 - INFO - fc.3.bias                                          | trainable |        1 params
2025-08-12 22:29:15,966 - INFO - --------------------------------------------------------------------------------
2025-08-12 22:29:15,975 - INFO - Total params:                                          208513 params (only trainable)
2025-08-12 22:29:15,985 - INFO - =====================================
2025-08-12 22:44:14,725 - INFO - Epoch 0 train=2.2723e-02 val=2.2427e-03 lr=1.00e-04 time=334.95s
2025-08-12 22:48:57,667 - INFO - Epoch 1 train=6.2867e-03 val=1.1379e-03 lr=1.00e-04 time=266.37s
2025-08-12 22:53:45,418 - INFO - Epoch 2 train=3.6614e-03 val=1.2391e-03 lr=1.00e-04 time=271.18s
2025-08-12 22:58:38,261 - INFO - Epoch 3 train=2.0000e-03 val=1.2032e-03 lr=1.00e-04 time=276.33s
2025-08-12 23:03:38,573 - INFO - Epoch 4 train=1.1192e-03 val=5.6654e-04 lr=1.00e-04 time=283.84s
2025-08-12 23:09:30,196 - INFO - Epoch 5 train=5.9559e-04 val=8.9163e-04 lr=1.00e-04 time=335.02s
2025-08-12 23:16:10,325 - INFO - Epoch 6 train=4.0951e-04 val=5.7827e-04 lr=1.00e-04 time=383.63s
2025-08-12 23:21:55,285 - INFO - Epoch 7 train=3.1060e-04 val=3.5550e-04 lr=1.00e-04 time=328.46s
2025-08-12 23:25:14,665 - INFO - Epoch 8 train=2.3761e-04 val=4.8509e-04 lr=1.00e-04 time=182.86s
2025-08-12 23:28:42,332 - INFO - Epoch 9 train=2.0217e-04 val=3.0042e-04 lr=1.00e-04 time=191.18s
2025-08-12 23:32:11,074 - INFO - Epoch 10 train=1.8876e-04 val=3.5375e-04 lr=1.00e-04 time=192.22s
2025-08-12 23:35:49,159 - INFO - Epoch 11 train=1.6527e-04 val=2.6464e-04 lr=1.00e-04 time=201.59s
2025-08-12 23:39:20,405 - INFO - Epoch 12 train=1.4900e-04 val=2.8292e-04 lr=1.00e-04 time=194.68s
2025-08-12 23:42:51,920 - INFO - Epoch 13 train=2.1938e-04 val=3.0634e-04 lr=1.00e-04 time=195.00s
2025-08-12 23:46:24,311 - INFO - Epoch 14 train=1.3704e-04 val=3.6347e-04 lr=1.00e-04 time=195.87s
2025-08-12 23:49:53,903 - INFO - Epoch 15 train=1.3580e-04 val=3.0101e-04 lr=1.00e-04 time=193.10s
2025-08-12 23:53:20,985 - INFO - Epoch 16 train=1.3260e-04 val=3.0864e-04 lr=1.00e-04 time=190.60s
2025-08-12 23:56:50,498 - INFO - Epoch 17 train=1.2779e-04 val=2.7150e-04 lr=1.00e-04 time=193.01s
2025-08-13 00:00:18,753 - INFO - Epoch 18 train=1.0744e-04 val=3.5201e-04 lr=5.00e-05 time=191.77s
2025-08-13 00:03:46,648 - INFO - Epoch 19 train=1.0336e-04 val=3.4272e-04 lr=5.00e-05 time=191.40s
2025-08-13 00:07:16,025 - INFO - Epoch 20 train=1.0237e-04 val=3.9322e-04 lr=5.00e-05 time=192.89s
2025-08-13 00:10:48,554 - INFO - Epoch 21 train=1.0328e-04 val=3.8363e-04 lr=5.00e-05 time=196.02s
2025-08-13 00:14:15,851 - INFO - Epoch 22 train=9.9646e-05 val=4.8348e-04 lr=5.00e-05 time=190.80s
2025-08-13 00:17:44,333 - INFO - Epoch 23 train=9.8422e-05 val=4.9786e-04 lr=5.00e-05 time=191.99s
2025-08-13 00:21:12,891 - INFO - Epoch 24 train=9.1085e-05 val=4.0165e-04 lr=2.50e-05 time=192.06s
2025-08-13 00:24:41,249 - INFO - Epoch 25 train=9.0751e-05 val=4.5738e-04 lr=2.50e-05 time=191.88s
2025-08-13 00:28:07,940 - INFO - Epoch 26 train=8.9891e-05 val=4.5964e-04 lr=2.50e-05 time=190.21s
2025-08-13 00:31:35,695 - INFO - Epoch 27 train=9.0781e-05 val=4.7109e-04 lr=2.50e-05 time=191.27s
2025-08-13 00:35:02,882 - INFO - Epoch 28 train=8.7675e-05 val=5.2180e-04 lr=2.50e-05 time=190.70s
2025-08-13 00:38:28,667 - INFO - Epoch 29 train=8.7188e-05 val=4.4292e-04 lr=2.50e-05 time=189.29s
2025-08-13 00:41:56,339 - INFO - Epoch 30 train=8.4346e-05 val=5.1190e-04 lr=1.25e-05 time=191.19s
2025-08-13 00:45:27,294 - INFO - Epoch 31 train=8.3343e-05 val=4.7098e-04 lr=1.25e-05 time=194.46s
2025-08-13 00:45:27,311 - INFO - Early stopping at epoch 31
2025-08-13 00:45:39,613 - INFO - Eval -> RMSE: 7.2272e-03, MAE: 5.6535e-03, R2: 0.9926
2025-08-13 00:45:39,619 - INFO - Test metrics -> RMSE: 7.2272e-03, MAE: 5.6535e-03, R2: 0.9926
2025-08-13 00:45:46,183 - INFO - ==== Joint Training Complete ====
