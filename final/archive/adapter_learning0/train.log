2025-08-05 21:50:14,734 - INFO - ============================================================
2025-08-05 21:50:14,734 - INFO - Incremental Learning with Cumulative Adapters
2025-08-05 21:50:14,734 - INFO - ============================================================
2025-08-05 21:50:14,734 - INFO - Configuration:
2025-08-05 21:50:14,734 - INFO -   Base directory: E:\00_Thesis\final\adapter_learning
2025-08-05 21:50:14,735 - INFO -   Number of tasks: 3
2025-08-05 21:50:14,735 - INFO -   Sequence length: 720
2025-08-05 21:50:14,735 - INFO -   Hidden size: 128
2025-08-05 21:50:14,735 - INFO -   Batch size: 32
2025-08-05 21:50:14,735 - INFO -   Learning rate: 1.00e-04
2025-08-05 21:50:14,735 - INFO -   Epochs: 200
2025-08-05 21:50:14,735 - INFO -   Patience: 20
2025-08-05 21:50:14,735 - INFO - ============================================================
2025-08-05 21:50:14,735 - INFO - ==== Incremental Learning with Adapters ====
2025-08-05 21:50:14,736 - INFO - Number of tasks: 3
2025-08-05 21:51:07,450 - INFO - Incremental training - Task 0 Train IDs: ['03', '27', '05', '21', '11'], size: 107395
2025-08-05 21:51:07,453 - INFO - Incremental training - Task 0 Val IDs: ['01'], size: 20028
2025-08-05 21:51:07,453 - INFO - Incremental training - Test Task 0 size: 8584
2025-08-05 21:51:07,453 - INFO - Incremental training - Task 1 Train IDs: ['23', '25', '07'], size: 66660
2025-08-05 21:51:07,453 - INFO - Incremental training - Task 1 Val IDs: ['19'], size: 16183
2025-08-05 21:51:07,453 - INFO - Incremental training - Test Task 1 size: 6937
2025-08-05 21:51:07,453 - INFO - Incremental training - Task 2 Train IDs: ['09', '15', '29'], size: 31589
2025-08-05 21:51:07,453 - INFO - Incremental training - Task 2 Val IDs: ['13'], size: 4511
2025-08-05 21:51:07,454 - INFO - Incremental training - Test Task 2 size: 1934
2025-08-05 21:51:07,474 - INFO -   (Scaler) Scaler centers: [ 3.3374245   0.101279   27.50083333]
2025-08-05 21:51:07,479 - INFO -   (Scaler) Scaler scales: [0.18253608 1.77971742 1.05683333]
2025-08-05 21:51:08,278 - INFO - Model architecture with adapters:
2025-08-05 21:51:08,279 - INFO - ========== Model Structure ==========
2025-08-05 21:51:08,279 - INFO - 
AdapterSOHLSTM(
  (lstm1): LSTM(3, 128, batch_first=True)
  (adapter1): WindowedAttentionAdapter(
    (down_proj): Linear(in_features=128, out_features=16, bias=True)
    (attention): MultiheadAttention(
      (out_proj): NonDynamicallyQuantizableLinear(in_features=16, out_features=16, bias=True)
    )
    (up_proj): Linear(in_features=16, out_features=128, bias=True)
    (layer_norm): LayerNorm((128,), eps=1e-05, elementwise_affine=True)
  )
  (dropout_between): Dropout(p=0.3, inplace=False)
  (lstm2): LSTM(128, 128, batch_first=True)
  (adapter2): WindowedAttentionAdapter(
    (down_proj): Linear(in_features=128, out_features=16, bias=True)
    (attention): MultiheadAttention(
      (out_proj): NonDynamicallyQuantizableLinear(in_features=16, out_features=16, bias=True)
    )
    (up_proj): Linear(in_features=16, out_features=128, bias=True)
    (layer_norm): LayerNorm((128,), eps=1e-05, elementwise_affine=True)
  )
  (fc): Sequential(
    (0): Linear(in_features=128, out_features=64, bias=True)
    (1): LeakyReLU(negative_slope=0.01)
    (2): Dropout(p=0.3, inplace=False)
    (3): Linear(in_features=64, out_features=1, bias=True)
  )
)
2025-08-05 21:51:08,279 - INFO - =====================================
2025-08-05 21:51:08,279 - INFO - ====== Model Parameters Details ======
2025-08-05 21:51:08,280 - INFO - lstm1.weight_ih_l0                                 | trainable |     1536 params
2025-08-05 21:51:08,280 - INFO - lstm1.weight_hh_l0                                 | trainable |    65536 params
2025-08-05 21:51:08,280 - INFO - lstm1.bias_ih_l0                                   | trainable |      512 params
2025-08-05 21:51:08,280 - INFO - lstm1.bias_hh_l0                                   | trainable |      512 params
2025-08-05 21:51:08,280 - INFO - adapter1.gate                                      | trainable |        1 params
2025-08-05 21:51:08,281 - INFO - adapter1.down_proj.weight                          | trainable |     2048 params
2025-08-05 21:51:08,281 - INFO - adapter1.down_proj.bias                            | trainable |       16 params
2025-08-05 21:51:08,281 - INFO - adapter1.attention.in_proj_weight                  | trainable |      768 params
2025-08-05 21:51:08,281 - INFO - adapter1.attention.in_proj_bias                    | trainable |       48 params
2025-08-05 21:51:08,281 - INFO - adapter1.attention.out_proj.weight                 | trainable |      256 params
2025-08-05 21:51:08,281 - INFO - adapter1.attention.out_proj.bias                   | trainable |       16 params
2025-08-05 21:51:08,281 - INFO - adapter1.up_proj.weight                            | trainable |     2048 params
2025-08-05 21:51:08,281 - INFO - adapter1.up_proj.bias                              | trainable |      128 params
2025-08-05 21:51:08,281 - INFO - adapter1.layer_norm.weight                         | trainable |      128 params
2025-08-05 21:51:08,281 - INFO - adapter1.layer_norm.bias                           | trainable |      128 params
2025-08-05 21:51:08,281 - INFO - lstm2.weight_ih_l0                                 | trainable |    65536 params
2025-08-05 21:51:08,281 - INFO - lstm2.weight_hh_l0                                 | trainable |    65536 params
2025-08-05 21:51:08,281 - INFO - lstm2.bias_ih_l0                                   | trainable |      512 params
2025-08-05 21:51:08,281 - INFO - lstm2.bias_hh_l0                                   | trainable |      512 params
2025-08-05 21:51:08,281 - INFO - adapter2.gate                                      | trainable |        1 params
2025-08-05 21:51:08,281 - INFO - adapter2.down_proj.weight                          | trainable |     2048 params
2025-08-05 21:51:08,281 - INFO - adapter2.down_proj.bias                            | trainable |       16 params
2025-08-05 21:51:08,282 - INFO - adapter2.attention.in_proj_weight                  | trainable |      768 params
2025-08-05 21:51:08,282 - INFO - adapter2.attention.in_proj_bias                    | trainable |       48 params
2025-08-05 21:51:08,282 - INFO - adapter2.attention.out_proj.weight                 | trainable |      256 params
2025-08-05 21:51:08,282 - INFO - adapter2.attention.out_proj.bias                   | trainable |       16 params
2025-08-05 21:51:08,282 - INFO - adapter2.up_proj.weight                            | trainable |     2048 params
2025-08-05 21:51:08,282 - INFO - adapter2.up_proj.bias                              | trainable |      128 params
2025-08-05 21:51:08,282 - INFO - adapter2.layer_norm.weight                         | trainable |      128 params
2025-08-05 21:51:08,282 - INFO - adapter2.layer_norm.bias                           | trainable |      128 params
2025-08-05 21:51:08,282 - INFO - fc.0.weight                                        | trainable |     8192 params
2025-08-05 21:51:08,282 - INFO - fc.0.bias                                          | trainable |       64 params
2025-08-05 21:51:08,282 - INFO - fc.3.weight                                        | trainable |       64 params
2025-08-05 21:51:08,282 - INFO - fc.3.bias                                          | trainable |        1 params
2025-08-05 21:51:08,282 - INFO - --------------------------------------------------------------------------------
2025-08-05 21:51:08,282 - INFO - Total params:                                          219683 params (only trainable)
2025-08-05 21:51:08,282 - INFO - =====================================
2025-08-05 21:51:08,282 - INFO - Adapter configuration:
2025-08-05 21:51:08,282 - INFO -   Window size: 144 (24 hours)
2025-08-05 21:51:08,282 - INFO -   Overlap: 72 (50%%)
2025-08-05 21:51:08,282 - INFO -   Reduction factor: 8
2025-08-05 21:51:08,282 - INFO -   Bottleneck size: 16
2025-08-05 21:51:08,283 - INFO - --- Training task0 ---
2025-08-05 21:51:08,297 - INFO - Task 0: Training full model (LSTM + Adapters)
2025-08-05 21:51:08,298 - INFO - All parameters unfrozen.
2025-08-05 21:51:08,298 - INFO - Task 0 - Trainable parameters: 219683
2025-08-05 22:00:40,190 - INFO - Epoch 0 train=1.3584e-02 val=2.4487e-04 lr=1.00e-04 time=568.26s
