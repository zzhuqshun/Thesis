2025-08-13 14:51:54,628 - INFO - ==== Starting Joint Training ====
2025-08-13 14:53:30,932 - INFO - Joint training - Train IDs: ['03', '05', '07', '09', '11', '15', '21', '23', '25', '27', '29'], size: 205644
2025-08-13 14:53:30,936 - INFO - Joint training - Val IDs: ['01', '19', '13'], size: 58177
2025-08-13 14:53:30,940 - INFO - Joint training - Test ID: 17, size: 22872
2025-08-13 14:53:30,965 - INFO -   (Scaler) Scaler centers: [ 3.342422    0.17992967 27.75      ]
2025-08-13 14:53:30,973 - INFO -   (Scaler) Scaler scales: [0.18428363 1.77955483 1.81783333]
2025-08-13 14:53:31,965 - INFO - ========== Model Structure ==========
2025-08-13 14:53:31,970 - INFO - 
SOHLSTM(
  (lstm): LSTM(3, 128, num_layers=2, batch_first=True, dropout=0.3)
  (fc): Sequential(
    (0): Linear(in_features=128, out_features=64, bias=True)
    (1): LeakyReLU(negative_slope=0.01)
    (2): Dropout(p=0.3, inplace=False)
    (3): Linear(in_features=64, out_features=1, bias=True)
  )
)
2025-08-13 14:53:31,975 - INFO - =====================================
2025-08-13 14:53:31,978 - INFO - ====== Model Parameters Details ======
2025-08-13 14:53:31,983 - INFO - lstm.weight_ih_l0                                  | trainable |     1536 params
2025-08-13 14:53:31,989 - INFO - lstm.weight_hh_l0                                  | trainable |    65536 params
2025-08-13 14:53:31,994 - INFO - lstm.bias_ih_l0                                    | trainable |      512 params
2025-08-13 14:53:31,995 - INFO - lstm.bias_hh_l0                                    | trainable |      512 params
2025-08-13 14:53:31,996 - INFO - lstm.weight_ih_l1                                  | trainable |    65536 params
2025-08-13 14:53:31,998 - INFO - lstm.weight_hh_l1                                  | trainable |    65536 params
2025-08-13 14:53:31,999 - INFO - lstm.bias_ih_l1                                    | trainable |      512 params
2025-08-13 14:53:32,001 - INFO - lstm.bias_hh_l1                                    | trainable |      512 params
2025-08-13 14:53:32,002 - INFO - fc.0.weight                                        | trainable |     8192 params
2025-08-13 14:53:32,004 - INFO - fc.0.bias                                          | trainable |       64 params
2025-08-13 14:53:32,005 - INFO - fc.3.weight                                        | trainable |       64 params
2025-08-13 14:53:32,007 - INFO - fc.3.bias                                          | trainable |        1 params
2025-08-13 14:53:32,008 - INFO - --------------------------------------------------------------------------------
2025-08-13 14:53:32,010 - INFO - Total params:                                          208513 params (only trainable)
2025-08-13 14:53:32,011 - INFO - =====================================
2025-08-13 14:59:49,744 - INFO - Epoch 0 train=2.2723e-02 val=2.2427e-03 lr=1.00e-04 time=211.16s
2025-08-13 15:03:22,887 - INFO - Epoch 1 train=6.2867e-03 val=1.1379e-03 lr=1.00e-04 time=213.07s
2025-08-13 15:06:54,116 - INFO - Epoch 2 train=3.6614e-03 val=1.2391e-03 lr=1.00e-04 time=211.19s
2025-08-13 15:10:25,873 - INFO - Epoch 3 train=2.0000e-03 val=1.2032e-03 lr=1.00e-04 time=211.75s
2025-08-13 15:13:55,205 - INFO - Epoch 4 train=1.1192e-03 val=5.6654e-04 lr=1.00e-04 time=209.29s
2025-08-13 15:17:26,137 - INFO - Epoch 5 train=5.9559e-04 val=8.9163e-04 lr=1.00e-04 time=210.90s
2025-08-13 15:20:58,280 - INFO - Epoch 6 train=4.0951e-04 val=5.7827e-04 lr=1.00e-04 time=212.13s
2025-08-13 15:24:42,250 - INFO - Epoch 7 train=3.1060e-04 val=3.5550e-04 lr=1.00e-04 time=223.96s
2025-08-13 15:28:19,463 - INFO - Epoch 8 train=2.3761e-04 val=4.8509e-04 lr=1.00e-04 time=217.16s
2025-08-13 15:31:49,609 - INFO - Epoch 9 train=2.0217e-04 val=3.0042e-04 lr=1.00e-04 time=210.14s
2025-08-13 15:35:23,996 - INFO - Epoch 10 train=1.8876e-04 val=3.5375e-04 lr=1.00e-04 time=214.34s
2025-08-13 15:38:58,925 - INFO - Epoch 11 train=1.6527e-04 val=2.6464e-04 lr=1.00e-04 time=214.93s
2025-08-13 15:42:32,657 - INFO - Epoch 12 train=1.4900e-04 val=2.8292e-04 lr=1.00e-04 time=213.69s
2025-08-13 15:46:08,072 - INFO - Epoch 13 train=2.1938e-04 val=3.0634e-04 lr=1.00e-04 time=215.36s
2025-08-13 15:49:33,897 - INFO - Epoch 14 train=1.3704e-04 val=3.6347e-04 lr=1.00e-04 time=205.82s
2025-08-13 15:53:02,549 - INFO - Epoch 15 train=1.3580e-04 val=3.0101e-04 lr=1.00e-04 time=208.63s
2025-08-13 15:56:37,272 - INFO - Epoch 16 train=1.3260e-04 val=3.0864e-04 lr=1.00e-04 time=214.71s
2025-08-13 16:00:02,484 - INFO - Epoch 17 train=1.2779e-04 val=2.7150e-04 lr=1.00e-04 time=205.21s
2025-08-13 16:03:25,267 - INFO - Epoch 18 train=1.0744e-04 val=3.5201e-04 lr=5.00e-05 time=202.76s
2025-08-13 16:03:25,272 - INFO - [SWA] Enabled at epoch 18 (lr 5.00e-05 â‰¤ 5.00e-05)
2025-08-13 16:06:46,020 - INFO - Epoch 19 train=1.0336e-04 val=3.4272e-04 lr=5.00e-05 time=200.70s
2025-08-13 16:10:04,564 - INFO - Epoch 20 train=1.0237e-04 val=3.9322e-04 lr=5.00e-05 time=198.54s
2025-08-13 16:13:22,220 - INFO - Epoch 21 train=1.0328e-04 val=3.8363e-04 lr=5.00e-05 time=197.65s
2025-08-13 16:16:37,681 - INFO - Epoch 22 train=9.9646e-05 val=4.8348e-04 lr=5.00e-05 time=195.46s
2025-08-13 16:19:50,848 - INFO - Epoch 23 train=9.8422e-05 val=4.9786e-04 lr=5.00e-05 time=193.16s
2025-08-13 16:23:04,813 - INFO - Epoch 24 train=9.7812e-05 val=3.8680e-04 lr=5.00e-05 time=193.96s
2025-08-13 16:26:18,134 - INFO - Epoch 25 train=9.6807e-05 val=4.5789e-04 lr=5.00e-05 time=193.32s
2025-08-13 16:29:30,428 - INFO - Epoch 26 train=9.6184e-05 val=4.5826e-04 lr=5.00e-05 time=192.29s
2025-08-13 16:32:41,874 - INFO - Epoch 27 train=9.6248e-05 val=4.3906e-04 lr=5.00e-05 time=191.44s
2025-08-13 16:36:23,026 - INFO - Epoch 28 train=9.4579e-05 val=5.4348e-04 lr=5.00e-05 time=221.15s
2025-08-13 16:40:10,384 - INFO - Epoch 29 train=9.3590e-05 val=3.1633e-04 lr=5.00e-05 time=227.35s
2025-08-13 16:44:12,442 - INFO - Epoch 30 train=9.5460e-05 val=3.4102e-04 lr=5.00e-05 time=242.05s
2025-08-13 16:48:42,372 - INFO - Epoch 31 train=9.9166e-05 val=3.7736e-04 lr=5.00e-05 time=269.91s
2025-08-13 16:48:42,377 - INFO - Early stopping at epoch 31
2025-08-13 16:48:59,177 - INFO - [SWA] val_loss=3.8431e-04 (best non-SWA=2.6464e-04)
2025-08-13 16:49:18,266 - INFO - Eval -> RMSE: 7.2272e-03, MAE: 5.6535e-03, R2: 0.9926
2025-08-13 16:49:18,286 - INFO - Test metrics -> RMSE: 7.2272e-03, MAE: 5.6535e-03, R2: 0.9926
2025-08-13 16:49:25,693 - INFO - ==== Joint Training Complete ====
