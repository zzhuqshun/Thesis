2025-08-14 16:28:57,161 - INFO - ==== Starting Joint Training ====
2025-08-14 16:30:39,145 - INFO - Joint training - Train IDs: ['03', '05', '07', '09', '11', '15', '21', '23', '25', '27', '29'], size: 205644
2025-08-14 16:30:39,167 - INFO - Joint training - Val IDs: ['01', '19', '13'], size: 58177
2025-08-14 16:30:39,186 - INFO - Joint training - Test ID: 17, size: 22872
2025-08-14 16:30:39,225 - INFO -   (Scaler) Scaler centers: [ 3.342422    0.17992967 27.75      ]
2025-08-14 16:30:39,249 - INFO -   (Scaler) Scaler scales: [0.18428363 1.77955483 1.81783333]
2025-08-14 16:30:40,659 - INFO - ========== Model Structure ==========
2025-08-14 16:30:40,676 - INFO - 
SOHLSTM(
  (lstm): LSTM(3, 128, num_layers=2, batch_first=True, dropout=0.3)
  (fc): Sequential(
    (0): Linear(in_features=128, out_features=64, bias=True)
    (1): LeakyReLU(negative_slope=0.01)
    (2): Dropout(p=0.3, inplace=False)
    (3): Linear(in_features=64, out_features=1, bias=True)
  )
)
2025-08-14 16:30:40,701 - INFO - =====================================
2025-08-14 16:30:40,722 - INFO - ====== Model Parameters Details ======
2025-08-14 16:30:40,746 - INFO - lstm.weight_ih_l0                                  | trainable |     1536 params
2025-08-14 16:30:40,763 - INFO - lstm.weight_hh_l0                                  | trainable |    65536 params
2025-08-14 16:30:40,785 - INFO - lstm.bias_ih_l0                                    | trainable |      512 params
2025-08-14 16:30:40,805 - INFO - lstm.bias_hh_l0                                    | trainable |      512 params
2025-08-14 16:30:40,825 - INFO - lstm.weight_ih_l1                                  | trainable |    65536 params
2025-08-14 16:30:40,837 - INFO - lstm.weight_hh_l1                                  | trainable |    65536 params
2025-08-14 16:30:40,861 - INFO - lstm.bias_ih_l1                                    | trainable |      512 params
2025-08-14 16:30:40,887 - INFO - lstm.bias_hh_l1                                    | trainable |      512 params
2025-08-14 16:30:40,908 - INFO - fc.0.weight                                        | trainable |     8192 params
2025-08-14 16:30:40,942 - INFO - fc.0.bias                                          | trainable |       64 params
2025-08-14 16:30:40,963 - INFO - fc.3.weight                                        | trainable |       64 params
2025-08-14 16:30:40,986 - INFO - fc.3.bias                                          | trainable |        1 params
2025-08-14 16:30:41,003 - INFO - --------------------------------------------------------------------------------
2025-08-14 16:30:41,031 - INFO - Total params:                                          208513 params (only trainable)
2025-08-14 16:30:41,043 - INFO - =====================================
2025-08-14 16:46:03,640 - INFO - Epoch 0 train=1.5200e-02 val=1.7813e-03 lr=1.00e-04 time=280.58s
2025-08-14 16:51:03,485 - INFO - Epoch 1 train=4.5171e-03 val=8.5575e-04 lr=1.00e-04 time=299.72s
2025-08-14 16:56:09,306 - INFO - Epoch 2 train=2.4124e-03 val=8.0248e-04 lr=1.00e-04 time=305.72s
2025-08-14 17:01:18,552 - INFO - Epoch 3 train=1.3278e-03 val=4.4559e-04 lr=1.00e-04 time=309.11s
2025-08-14 17:07:50,672 - INFO - Epoch 4 train=8.7230e-04 val=7.1402e-04 lr=1.00e-04 time=392.00s
2025-08-14 17:14:21,126 - INFO - Epoch 5 train=6.2208e-04 val=5.5422e-04 lr=1.00e-04 time=390.41s
2025-08-14 17:19:41,418 - INFO - Epoch 6 train=5.0230e-04 val=5.1732e-04 lr=1.00e-04 time=320.24s
2025-08-14 17:23:12,164 - INFO - Epoch 7 train=4.4738e-04 val=8.8685e-04 lr=1.00e-04 time=210.73s
2025-08-14 17:26:37,983 - INFO - Epoch 8 train=3.9351e-04 val=4.0182e-04 lr=1.00e-04 time=205.82s
2025-08-14 17:30:55,191 - INFO - Epoch 9 train=3.3946e-04 val=3.9566e-04 lr=1.00e-04 time=257.14s
2025-08-14 17:34:56,797 - INFO - Epoch 10 train=3.1617e-04 val=5.7508e-04 lr=1.00e-04 time=241.53s
2025-08-14 17:39:13,424 - INFO - Epoch 11 train=3.0427e-04 val=3.6900e-04 lr=1.00e-04 time=256.61s
2025-08-14 17:43:12,363 - INFO - Epoch 12 train=3.2734e-04 val=3.9543e-04 lr=1.00e-04 time=238.87s
2025-08-14 17:46:49,552 - INFO - Epoch 13 train=2.4640e-04 val=6.1263e-04 lr=1.00e-04 time=217.17s
2025-08-14 17:50:16,077 - INFO - Epoch 14 train=2.2040e-04 val=6.0707e-04 lr=1.00e-04 time=206.51s
2025-08-14 17:53:41,853 - INFO - Epoch 15 train=2.1645e-04 val=6.0363e-04 lr=1.00e-04 time=205.75s
2025-08-14 17:57:08,115 - INFO - Epoch 16 train=1.9010e-04 val=5.3828e-04 lr=1.00e-04 time=206.25s
2025-08-14 18:00:29,151 - INFO - Epoch 17 train=1.8661e-04 val=5.8151e-04 lr=5.00e-05 time=201.02s
2025-08-14 18:03:49,301 - INFO - Epoch 18 train=1.5575e-04 val=5.7679e-04 lr=5.00e-05 time=200.14s
2025-08-14 18:07:09,845 - INFO - Epoch 19 train=1.4938e-04 val=6.5517e-04 lr=5.00e-05 time=200.52s
2025-08-14 18:10:30,773 - INFO - Epoch 20 train=1.4800e-04 val=6.0179e-04 lr=5.00e-05 time=200.91s
2025-08-14 18:13:59,730 - INFO - Epoch 21 train=1.4293e-04 val=6.0304e-04 lr=5.00e-05 time=208.95s
2025-08-14 18:17:28,943 - INFO - Epoch 22 train=1.4109e-04 val=6.1517e-04 lr=5.00e-05 time=209.18s
2025-08-14 18:20:57,985 - INFO - Epoch 23 train=1.3941e-04 val=7.8235e-04 lr=2.50e-05 time=209.04s
2025-08-14 18:24:26,655 - INFO - Epoch 24 train=1.2637e-04 val=7.0860e-04 lr=2.50e-05 time=208.66s
2025-08-14 18:27:54,197 - INFO - Epoch 25 train=1.2514e-04 val=7.5015e-04 lr=2.50e-05 time=207.54s
2025-08-14 18:31:23,408 - INFO - Epoch 26 train=1.2420e-04 val=7.2948e-04 lr=2.50e-05 time=209.21s
2025-08-14 18:34:51,885 - INFO - Epoch 27 train=1.2383e-04 val=8.7327e-04 lr=2.50e-05 time=208.46s
2025-08-14 18:38:14,783 - INFO - Epoch 28 train=1.2344e-04 val=1.0020e-03 lr=2.50e-05 time=202.89s
2025-08-14 18:41:37,352 - INFO - Epoch 29 train=1.2306e-04 val=7.4373e-04 lr=1.25e-05 time=202.56s
2025-08-14 18:45:14,519 - INFO - Epoch 30 train=1.1531e-04 val=7.6253e-04 lr=1.25e-05 time=217.14s
2025-08-14 18:49:10,802 - INFO - Epoch 31 train=1.1583e-04 val=8.2568e-04 lr=1.25e-05 time=236.28s
2025-08-14 18:49:10,823 - INFO - Early stopping at epoch 31
2025-08-14 18:49:24,324 - INFO - Eval -> RMSE: 2.1090e-02, MAE: 1.5730e-02, R2: 0.9372
2025-08-14 18:49:24,331 - INFO - Test metrics -> RMSE: 2.1090e-02, MAE: 1.5730e-02, R2: 0.9372
2025-08-14 18:49:31,471 - INFO - ==== Joint Training Complete ====
