2025-08-11 20:39:43,127 - INFO - ==== Starting Joint Training ====
2025-08-11 20:41:13,088 - INFO - Joint training - Train IDs: ['03', '05', '07', '09', '11', '15', '21', '23', '25', '27', '29'], size: 205644
2025-08-11 20:41:13,104 - INFO - Joint training - Val IDs: ['01', '19', '13'], size: 58177
2025-08-11 20:41:13,114 - INFO - Joint training - Test ID: 17, size: 22872
2025-08-11 20:41:13,147 - INFO -   (Scaler) Scaler centers: [ 3.342422    0.17992967 27.75      ]
2025-08-11 20:41:13,163 - INFO -   (Scaler) Scaler scales: [0.18428363 1.77955483 1.81783333]
2025-08-11 20:41:14,131 - INFO - ========== Model Structure ==========
2025-08-11 20:41:14,141 - INFO - 
SOHLSTM(
  (lstm): LSTM(3, 128, num_layers=2, batch_first=True, dropout=0.3)
  (ln): LayerNorm((128,), eps=1e-05, elementwise_affine=True)
  (fc): Sequential(
    (0): Linear(in_features=128, out_features=64, bias=True)
    (1): LeakyReLU(negative_slope=0.01)
    (2): Dropout(p=0.3, inplace=False)
    (3): Linear(in_features=64, out_features=1, bias=True)
  )
)
2025-08-11 20:41:14,148 - INFO - =====================================
2025-08-11 20:41:14,158 - INFO - ====== Model Parameters Details ======
2025-08-11 20:41:14,172 - INFO - lstm.weight_ih_l0                                  | trainable |     1536 params
2025-08-11 20:41:14,184 - INFO - lstm.weight_hh_l0                                  | trainable |    65536 params
2025-08-11 20:41:14,196 - INFO - lstm.bias_ih_l0                                    | trainable |      512 params
2025-08-11 20:41:14,205 - INFO - lstm.bias_hh_l0                                    | trainable |      512 params
2025-08-11 20:41:14,215 - INFO - lstm.weight_ih_l1                                  | trainable |    65536 params
2025-08-11 20:41:14,224 - INFO - lstm.weight_hh_l1                                  | trainable |    65536 params
2025-08-11 20:41:14,240 - INFO - lstm.bias_ih_l1                                    | trainable |      512 params
2025-08-11 20:41:14,259 - INFO - lstm.bias_hh_l1                                    | trainable |      512 params
2025-08-11 20:41:14,267 - INFO - ln.weight                                          | trainable |      128 params
2025-08-11 20:41:14,276 - INFO - ln.bias                                            | trainable |      128 params
2025-08-11 20:41:14,291 - INFO - fc.0.weight                                        | trainable |     8192 params
2025-08-11 20:41:14,301 - INFO - fc.0.bias                                          | trainable |       64 params
2025-08-11 20:41:14,312 - INFO - fc.3.weight                                        | trainable |       64 params
2025-08-11 20:41:14,333 - INFO - fc.3.bias                                          | trainable |        1 params
2025-08-11 20:41:14,343 - INFO - --------------------------------------------------------------------------------
2025-08-11 20:41:14,356 - INFO - Total params:                                          208769 params (only trainable)
2025-08-11 20:41:14,371 - INFO - =====================================
2025-08-11 20:55:11,717 - INFO - Epoch 0 train=1.2425e-02 val=9.4445e-04 lr=1.00e-04 time=319.82s
2025-08-11 21:00:47,122 - INFO - Epoch 1 train=4.5651e-03 val=1.1317e-03 lr=1.00e-04 time=318.77s
2025-08-11 21:06:16,555 - INFO - Epoch 2 train=2.4808e-03 val=5.6501e-04 lr=1.00e-04 time=312.94s
2025-08-11 21:11:40,467 - INFO - Epoch 3 train=1.4835e-03 val=5.2506e-04 lr=1.00e-04 time=307.27s
2025-08-11 21:16:55,202 - INFO - Epoch 4 train=9.5546e-04 val=4.7210e-04 lr=1.00e-04 time=298.11s
2025-08-11 21:21:33,355 - INFO - Epoch 5 train=7.3173e-04 val=3.9517e-04 lr=1.00e-04 time=261.52s
2025-08-11 21:24:44,579 - INFO - Epoch 6 train=5.7897e-04 val=4.7117e-04 lr=1.00e-04 time=174.71s
2025-08-11 21:27:55,669 - INFO - Epoch 7 train=4.3229e-04 val=4.7051e-04 lr=1.00e-04 time=174.58s
2025-08-11 21:31:06,528 - INFO - Epoch 8 train=3.7713e-04 val=4.4831e-04 lr=1.00e-04 time=174.36s
2025-08-11 21:34:17,547 - INFO - Epoch 9 train=3.3508e-04 val=4.5604e-04 lr=1.00e-04 time=174.53s
2025-08-11 21:37:28,774 - INFO - Epoch 10 train=3.6097e-04 val=4.2507e-04 lr=1.00e-04 time=174.75s
2025-08-11 21:40:41,784 - INFO - Epoch 11 train=2.7168e-04 val=5.4405e-04 lr=1.00e-04 time=176.49s
2025-08-11 21:43:53,123 - INFO - Epoch 12 train=2.1571e-04 val=6.9363e-04 lr=5.00e-05 time=174.85s
2025-08-11 21:47:04,535 - INFO - Epoch 13 train=2.0772e-04 val=7.3519e-04 lr=5.00e-05 time=174.91s
2025-08-11 21:50:16,680 - INFO - Epoch 14 train=1.9365e-04 val=5.7570e-04 lr=5.00e-05 time=175.59s
2025-08-11 21:53:31,457 - INFO - Epoch 15 train=2.7495e-04 val=4.2706e-04 lr=5.00e-05 time=178.34s
2025-08-11 21:56:43,776 - INFO - Epoch 16 train=1.9665e-04 val=7.3274e-04 lr=5.00e-05 time=175.87s
2025-08-11 21:59:55,857 - INFO - Epoch 17 train=1.6379e-04 val=6.9913e-04 lr=5.00e-05 time=175.57s
2025-08-11 22:03:06,965 - INFO - Epoch 18 train=1.7604e-04 val=3.6969e-04 lr=2.50e-05 time=174.65s
2025-08-11 22:06:17,788 - INFO - Epoch 19 train=2.3571e-04 val=5.9030e-04 lr=2.50e-05 time=174.33s
2025-08-11 22:09:28,629 - INFO - Epoch 20 train=1.8328e-04 val=6.7793e-04 lr=2.50e-05 time=174.37s
2025-08-11 22:12:39,581 - INFO - Epoch 21 train=1.4982e-04 val=4.9713e-04 lr=2.50e-05 time=174.49s
2025-08-11 22:15:50,189 - INFO - Epoch 22 train=1.3252e-04 val=1.0031e-03 lr=2.50e-05 time=174.12s
2025-08-11 22:19:00,307 - INFO - Epoch 23 train=1.2585e-04 val=7.9445e-04 lr=2.50e-05 time=173.60s
2025-08-11 22:22:10,680 - INFO - Epoch 24 train=1.2390e-04 val=9.0564e-04 lr=2.50e-05 time=173.84s
2025-08-11 22:25:21,376 - INFO - Epoch 25 train=1.1204e-04 val=7.2864e-04 lr=1.25e-05 time=174.15s
2025-08-11 22:28:32,343 - INFO - Epoch 26 train=1.1206e-04 val=8.9337e-04 lr=1.25e-05 time=174.44s
2025-08-11 22:31:42,737 - INFO - Epoch 27 train=1.0810e-04 val=8.7473e-04 lr=1.25e-05 time=173.86s
2025-08-11 22:34:52,722 - INFO - Epoch 28 train=1.0872e-04 val=8.2377e-04 lr=1.25e-05 time=173.45s
2025-08-11 22:38:03,467 - INFO - Epoch 29 train=1.0714e-04 val=8.5736e-04 lr=1.25e-05 time=174.22s
2025-08-11 22:41:14,347 - INFO - Epoch 30 train=1.0703e-04 val=9.7117e-04 lr=1.25e-05 time=174.35s
2025-08-11 22:44:24,955 - INFO - Epoch 31 train=1.0004e-04 val=8.8562e-04 lr=6.25e-06 time=174.07s
2025-08-11 22:47:34,472 - INFO - Epoch 32 train=1.0012e-04 val=8.9160e-04 lr=6.25e-06 time=172.98s
2025-08-11 22:50:36,910 - INFO - Epoch 33 train=9.8468e-05 val=9.7035e-04 lr=6.25e-06 time=165.91s
2025-08-11 22:54:33,080 - INFO - Epoch 34 train=9.7892e-05 val=9.0814e-04 lr=6.25e-06 time=219.64s
2025-08-11 22:59:38,662 - INFO - Epoch 35 train=9.9824e-05 val=8.9958e-04 lr=6.25e-06 time=289.04s
2025-08-11 23:04:18,774 - INFO - Epoch 36 train=9.9227e-05 val=9.3686e-04 lr=6.25e-06 time=263.57s
2025-08-11 23:08:37,485 - INFO - Epoch 37 train=9.5550e-05 val=9.1946e-04 lr=3.13e-06 time=242.14s
2025-08-11 23:12:37,909 - INFO - Epoch 38 train=9.6163e-05 val=9.2517e-04 lr=3.13e-06 time=223.89s
2025-08-11 23:12:37,923 - INFO - Early stopping at epoch 38
2025-08-11 23:12:51,727 - INFO - Eval -> RMSE: 1.3407e-02, MAE: 1.1240e-02, R2: 0.9746
2025-08-11 23:12:51,739 - INFO - Test metrics -> RMSE: 1.3407e-02, MAE: 1.1240e-02, R2: 0.9746
2025-08-11 23:12:58,508 - INFO - ==== Joint Training Complete ====
