2025-08-13 20:23:52,959 - INFO - ==== Starting Joint Training ====
2025-08-13 20:25:21,326 - INFO - Joint training - Train IDs: ['03', '05', '07', '09', '11', '15', '21', '23', '25', '27', '29'], size: 205644
2025-08-13 20:25:21,330 - INFO - Joint training - Val IDs: ['01', '19', '13'], size: 58177
2025-08-13 20:25:21,332 - INFO - Joint training - Test ID: 17, size: 22872
2025-08-13 20:25:21,350 - INFO -   (Scaler) Scaler centers: [ 3.342422    0.17992967 27.75      ]
2025-08-13 20:25:21,353 - INFO -   (Scaler) Scaler scales: [0.18428363 1.77955483 1.81783333]
2025-08-13 20:25:21,736 - INFO - ========== Model Structure ==========
2025-08-13 20:25:21,737 - INFO - 
SOHLSTM(
  (lstm): LSTM(3, 128, num_layers=2, batch_first=True, dropout=0.3)
  (fc): Sequential(
    (0): Linear(in_features=128, out_features=64, bias=True)
    (1): LeakyReLU(negative_slope=0.01)
    (2): Dropout(p=0.3, inplace=False)
    (3): Linear(in_features=64, out_features=1, bias=True)
  )
)
2025-08-13 20:25:21,738 - INFO - =====================================
2025-08-13 20:25:21,739 - INFO - ====== Model Parameters Details ======
2025-08-13 20:25:21,740 - INFO - lstm.weight_ih_l0                                  | trainable |     1536 params
2025-08-13 20:25:21,741 - INFO - lstm.weight_hh_l0                                  | trainable |    65536 params
2025-08-13 20:25:21,742 - INFO - lstm.bias_ih_l0                                    | trainable |      512 params
2025-08-13 20:25:21,742 - INFO - lstm.bias_hh_l0                                    | trainable |      512 params
2025-08-13 20:25:21,744 - INFO - lstm.weight_ih_l1                                  | trainable |    65536 params
2025-08-13 20:25:21,746 - INFO - lstm.weight_hh_l1                                  | trainable |    65536 params
2025-08-13 20:25:21,748 - INFO - lstm.bias_ih_l1                                    | trainable |      512 params
2025-08-13 20:25:21,751 - INFO - lstm.bias_hh_l1                                    | trainable |      512 params
2025-08-13 20:25:21,754 - INFO - fc.0.weight                                        | trainable |     8192 params
2025-08-13 20:25:21,756 - INFO - fc.0.bias                                          | trainable |       64 params
2025-08-13 20:25:21,759 - INFO - fc.3.weight                                        | trainable |       64 params
2025-08-13 20:25:21,762 - INFO - fc.3.bias                                          | trainable |        1 params
2025-08-13 20:25:21,765 - INFO - --------------------------------------------------------------------------------
2025-08-13 20:25:21,768 - INFO - Total params:                                          208513 params (only trainable)
2025-08-13 20:25:21,771 - INFO - =====================================
2025-08-13 20:30:01,116 - INFO - Epoch 0 train=2.0103e-02 val=3.0138e-03 lr=1.00e-04 time=188.81s
2025-08-13 20:33:14,013 - INFO - Epoch 1 train=6.4877e-03 val=1.8695e-03 lr=1.00e-04 time=192.84s
2025-08-13 20:36:30,947 - INFO - Epoch 2 train=3.7075e-03 val=1.5086e-03 lr=1.00e-04 time=196.91s
2025-08-13 20:39:48,598 - INFO - Epoch 3 train=2.2153e-03 val=5.7136e-04 lr=1.00e-04 time=197.63s
2025-08-13 20:42:57,405 - INFO - Epoch 4 train=1.4705e-03 val=7.1862e-04 lr=1.00e-04 time=188.77s
2025-08-13 20:46:05,067 - INFO - Epoch 5 train=8.8448e-04 val=5.1181e-04 lr=1.00e-04 time=187.66s
2025-08-13 20:49:13,619 - INFO - Epoch 6 train=6.1931e-04 val=5.6080e-04 lr=1.00e-04 time=188.50s
2025-08-13 20:52:22,159 - INFO - Epoch 7 train=5.5540e-04 val=7.1527e-04 lr=1.00e-04 time=188.52s
2025-08-13 20:55:30,494 - INFO - Epoch 8 train=4.1717e-04 val=5.2583e-04 lr=1.00e-04 time=188.33s
2025-08-13 20:58:38,515 - INFO - Epoch 9 train=3.1849e-04 val=5.8901e-04 lr=1.00e-04 time=188.01s
2025-08-13 21:01:47,073 - INFO - Epoch 10 train=3.2540e-04 val=4.2229e-04 lr=1.00e-04 time=188.55s
2025-08-13 21:04:56,481 - INFO - Epoch 11 train=2.3000e-04 val=4.0196e-04 lr=1.00e-04 time=189.38s
2025-08-13 21:08:05,525 - INFO - Epoch 12 train=1.8827e-04 val=3.5018e-04 lr=1.00e-04 time=189.02s
2025-08-13 21:11:14,638 - INFO - Epoch 13 train=1.6811e-04 val=3.4585e-04 lr=1.00e-04 time=189.07s
2025-08-13 21:14:26,369 - INFO - Epoch 14 train=1.5194e-04 val=4.3465e-04 lr=1.00e-04 time=191.70s
2025-08-13 21:17:40,284 - INFO - Epoch 15 train=2.9069e-04 val=4.1343e-04 lr=1.00e-04 time=193.91s
2025-08-13 21:20:53,807 - INFO - Epoch 16 train=1.7973e-04 val=5.2380e-04 lr=1.00e-04 time=193.52s
2025-08-13 21:24:06,914 - INFO - Epoch 17 train=1.8198e-04 val=3.6796e-04 lr=1.00e-04 time=193.11s
2025-08-13 21:27:16,140 - INFO - Epoch 18 train=1.3916e-04 val=3.5724e-04 lr=1.00e-04 time=189.22s
2025-08-13 21:30:22,306 - INFO - Epoch 19 train=1.3126e-04 val=3.0565e-04 lr=1.00e-04 time=186.16s
2025-08-13 21:34:24,643 - INFO - Epoch 20 train=1.3475e-04 val=3.5879e-04 lr=1.00e-04 time=242.31s
2025-08-13 21:39:32,610 - INFO - Epoch 21 train=1.3688e-04 val=2.8374e-04 lr=1.00e-04 time=307.95s
2025-08-13 21:43:17,100 - INFO - Epoch 22 train=1.2572e-04 val=3.2056e-04 lr=1.00e-04 time=224.44s
2025-08-13 21:48:12,638 - INFO - Epoch 23 train=1.2643e-04 val=3.7418e-04 lr=1.00e-04 time=295.52s
2025-08-13 21:52:31,837 - INFO - Epoch 24 train=1.1971e-04 val=3.5840e-04 lr=1.00e-04 time=259.20s
2025-08-13 21:57:25,433 - INFO - Epoch 25 train=1.2022e-04 val=4.1042e-04 lr=1.00e-04 time=293.57s
2025-08-13 22:01:57,683 - INFO - Epoch 26 train=1.1774e-04 val=4.1831e-04 lr=1.00e-04 time=272.24s
2025-08-13 22:06:22,703 - INFO - Epoch 27 train=1.1754e-04 val=2.8700e-04 lr=5.00e-05 time=265.01s
2025-08-13 22:11:21,015 - INFO - Epoch 28 train=1.0423e-04 val=3.6652e-04 lr=5.00e-05 time=298.05s
2025-08-13 22:16:16,510 - INFO - Epoch 29 train=1.0484e-04 val=4.1121e-04 lr=5.00e-05 time=295.49s
2025-08-13 22:21:07,007 - INFO - Epoch 30 train=1.0184e-04 val=4.4138e-04 lr=5.00e-05 time=290.47s
2025-08-13 22:26:04,791 - INFO - Epoch 31 train=1.0198e-04 val=5.1548e-04 lr=5.00e-05 time=297.77s
2025-08-13 22:31:10,089 - INFO - Epoch 32 train=1.0403e-04 val=5.4911e-04 lr=5.00e-05 time=305.29s
2025-08-13 22:36:46,800 - INFO - Epoch 33 train=1.0230e-04 val=5.5806e-04 lr=2.50e-05 time=336.70s
2025-08-13 22:42:22,543 - INFO - Epoch 34 train=9.3967e-05 val=4.3774e-04 lr=2.50e-05 time=335.72s
2025-08-13 22:47:32,086 - INFO - Epoch 35 train=9.2933e-05 val=5.2886e-04 lr=2.50e-05 time=309.51s
2025-08-13 22:51:53,823 - INFO - Epoch 36 train=9.5078e-05 val=4.9392e-04 lr=2.50e-05 time=261.73s
2025-08-13 22:57:52,427 - INFO - Epoch 37 train=9.4110e-05 val=4.9749e-04 lr=2.50e-05 time=358.59s
2025-08-13 23:03:41,853 - INFO - Epoch 38 train=9.3760e-05 val=4.9682e-04 lr=2.50e-05 time=349.39s
2025-08-13 23:08:52,326 - INFO - Epoch 39 train=9.4686e-05 val=5.2347e-04 lr=1.25e-05 time=310.46s
2025-08-13 23:12:00,283 - INFO - Epoch 40 train=9.0580e-05 val=5.1786e-04 lr=1.25e-05 time=187.96s
2025-08-13 23:15:08,319 - INFO - Epoch 41 train=9.0289e-05 val=5.4561e-04 lr=1.25e-05 time=188.03s
2025-08-13 23:15:08,320 - INFO - Early stopping at epoch 41
2025-08-13 23:15:18,974 - INFO - Eval -> RMSE: 1.5555e-02, MAE: 1.1609e-02, R2: 0.9658
2025-08-13 23:15:18,976 - INFO - Test metrics -> RMSE: 1.5555e-02, MAE: 1.1609e-02, R2: 0.9658
2025-08-13 23:15:25,328 - INFO - ==== Joint Training Complete ====
