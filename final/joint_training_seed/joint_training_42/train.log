2025-08-06 11:23:08,221 - INFO - ==== Starting Joint Training ====
2025-08-06 11:24:45,928 - INFO - Joint training - Train IDs: ['03', '05', '07', '09', '11', '15', '21', '23', '25', '27', '29'], size: 205644
2025-08-06 11:24:45,939 - INFO - Joint training - Val IDs: ['01', '19', '13'], size: 58177
2025-08-06 11:24:45,943 - INFO - Joint training - Test ID: 17, size: 22872
2025-08-06 11:24:45,967 - INFO -   (Scaler) Scaler centers: [ 3.342422    0.17992967 27.75      ]
2025-08-06 11:24:45,992 - INFO -   (Scaler) Scaler scales: [0.18428363 1.77955483 1.81783333]
2025-08-06 11:24:47,048 - INFO - ========== Model Structure ==========
2025-08-06 11:24:47,050 - INFO - 
SOHLSTM(
  (lstm): LSTM(3, 128, num_layers=2, batch_first=True, dropout=0.3)
  (fc): Sequential(
    (0): Linear(in_features=128, out_features=64, bias=True)
    (1): LeakyReLU(negative_slope=0.01)
    (2): Dropout(p=0.3, inplace=False)
    (3): Linear(in_features=64, out_features=1, bias=True)
  )
)
2025-08-06 11:24:47,052 - INFO - =====================================
2025-08-06 11:24:47,054 - INFO - ====== Model Parameters Details ======
2025-08-06 11:24:47,060 - INFO - lstm.weight_ih_l0                                  | trainable |     1536 params
2025-08-06 11:24:47,061 - INFO - lstm.weight_hh_l0                                  | trainable |    65536 params
2025-08-06 11:24:47,063 - INFO - lstm.bias_ih_l0                                    | trainable |      512 params
2025-08-06 11:24:47,064 - INFO - lstm.bias_hh_l0                                    | trainable |      512 params
2025-08-06 11:24:47,066 - INFO - lstm.weight_ih_l1                                  | trainable |    65536 params
2025-08-06 11:24:47,067 - INFO - lstm.weight_hh_l1                                  | trainable |    65536 params
2025-08-06 11:24:47,069 - INFO - lstm.bias_ih_l1                                    | trainable |      512 params
2025-08-06 11:24:47,070 - INFO - lstm.bias_hh_l1                                    | trainable |      512 params
2025-08-06 11:24:47,072 - INFO - fc.0.weight                                        | trainable |     8192 params
2025-08-06 11:24:47,073 - INFO - fc.0.bias                                          | trainable |       64 params
2025-08-06 11:24:47,075 - INFO - fc.3.weight                                        | trainable |       64 params
2025-08-06 11:24:47,076 - INFO - fc.3.bias                                          | trainable |        1 params
2025-08-06 11:24:47,078 - INFO - --------------------------------------------------------------------------------
2025-08-06 11:24:47,079 - INFO - Total params:                                          208513 params (only trainable)
2025-08-06 11:24:47,081 - INFO - =====================================
2025-08-06 11:32:35,513 - INFO - Epoch 0 train=2.2723e-02 val=2.2427e-03 lr=1.00e-04 time=247.65s
2025-08-06 11:36:47,247 - INFO - Epoch 1 train=6.2867e-03 val=1.1379e-03 lr=1.00e-04 time=251.59s
2025-08-06 11:41:42,012 - INFO - Epoch 2 train=3.6614e-03 val=1.2391e-03 lr=1.00e-04 time=294.64s
2025-08-06 11:46:26,411 - INFO - Epoch 3 train=2.0000e-03 val=1.2032e-03 lr=1.00e-04 time=284.32s
2025-08-06 11:50:40,451 - INFO - Epoch 4 train=1.1192e-03 val=5.6654e-04 lr=1.00e-04 time=254.03s
2025-08-06 11:54:35,661 - INFO - Epoch 5 train=5.9559e-04 val=8.9163e-04 lr=1.00e-04 time=235.09s
2025-08-06 11:57:57,274 - INFO - Epoch 6 train=4.0951e-04 val=5.7827e-04 lr=1.00e-04 time=201.61s
2025-08-06 12:01:23,037 - INFO - Epoch 7 train=3.1060e-04 val=3.5550e-04 lr=1.00e-04 time=205.75s
2025-08-06 12:04:53,409 - INFO - Epoch 8 train=2.3761e-04 val=4.8509e-04 lr=1.00e-04 time=210.33s
2025-08-06 12:08:54,315 - INFO - Epoch 9 train=2.0217e-04 val=3.0042e-04 lr=1.00e-04 time=240.90s
2025-08-06 12:13:21,761 - INFO - Epoch 10 train=1.8876e-04 val=3.5375e-04 lr=1.00e-04 time=267.37s
2025-08-06 12:18:42,331 - INFO - Epoch 11 train=1.6527e-04 val=2.6464e-04 lr=1.00e-04 time=320.54s
2025-08-06 12:23:43,272 - INFO - Epoch 12 train=1.4900e-04 val=2.8292e-04 lr=1.00e-04 time=300.84s
2025-08-06 12:28:41,762 - INFO - Epoch 13 train=2.1938e-04 val=3.0634e-04 lr=1.00e-04 time=298.46s
2025-08-06 12:33:41,556 - INFO - Epoch 14 train=1.3704e-04 val=3.6347e-04 lr=1.00e-04 time=299.76s
2025-08-06 12:38:39,316 - INFO - Epoch 15 train=1.3580e-04 val=3.0101e-04 lr=1.00e-04 time=297.75s
2025-08-06 12:43:25,076 - INFO - Epoch 16 train=1.3260e-04 val=3.0864e-04 lr=1.00e-04 time=285.73s
2025-08-06 12:46:50,347 - INFO - Epoch 17 train=1.2779e-04 val=2.7150e-04 lr=1.00e-04 time=205.27s
2025-08-06 12:50:11,860 - INFO - Epoch 18 train=1.0744e-04 val=3.5201e-04 lr=5.00e-05 time=201.51s
2025-08-06 12:53:30,760 - INFO - Epoch 19 train=1.0336e-04 val=3.4272e-04 lr=5.00e-05 time=198.90s
2025-08-06 12:56:50,827 - INFO - Epoch 20 train=1.0237e-04 val=3.9322e-04 lr=5.00e-05 time=200.07s
2025-08-06 13:00:18,808 - INFO - Epoch 21 train=1.0328e-04 val=3.8363e-04 lr=5.00e-05 time=207.98s
2025-08-06 13:03:47,261 - INFO - Epoch 22 train=9.9646e-05 val=4.8348e-04 lr=5.00e-05 time=208.44s
2025-08-06 13:07:10,227 - INFO - Epoch 23 train=9.8422e-05 val=4.9786e-04 lr=5.00e-05 time=202.95s
2025-08-06 13:10:36,663 - INFO - Epoch 24 train=9.1085e-05 val=4.0165e-04 lr=2.50e-05 time=206.31s
2025-08-06 13:13:55,022 - INFO - Epoch 25 train=9.0751e-05 val=4.5738e-04 lr=2.50e-05 time=198.35s
2025-08-06 13:17:13,681 - INFO - Epoch 26 train=8.9891e-05 val=4.5964e-04 lr=2.50e-05 time=198.65s
2025-08-06 13:20:32,728 - INFO - Epoch 27 train=9.0781e-05 val=4.7109e-04 lr=2.50e-05 time=199.03s
2025-08-06 13:23:52,671 - INFO - Epoch 28 train=8.7675e-05 val=5.2180e-04 lr=2.50e-05 time=199.94s
2025-08-06 13:27:20,396 - INFO - Epoch 29 train=8.7188e-05 val=4.4292e-04 lr=2.50e-05 time=207.71s
2025-08-06 13:30:39,709 - INFO - Epoch 30 train=8.4346e-05 val=5.1190e-04 lr=1.25e-05 time=199.31s
2025-08-06 13:34:00,067 - INFO - Epoch 31 train=8.3343e-05 val=4.7098e-04 lr=1.25e-05 time=200.34s
2025-08-06 13:34:00,071 - INFO - Early stopping at epoch 31
2025-08-06 13:34:13,057 - INFO - Eval -> RMSE: 7.2272e-03, MAE: 5.6535e-03, R2: 0.9926
2025-08-06 13:34:13,062 - INFO - Test metrics -> RMSE: 7.2272e-03, MAE: 5.6535e-03, R2: 0.9926
2025-08-06 13:34:19,630 - INFO - ==== Joint Training Complete ====
