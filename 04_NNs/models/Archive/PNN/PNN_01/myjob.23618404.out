Using device: cuda:0
Current model_type: structure_based(PNN)

Test cell: df_17.parquet
Base training cells: ['df_27.parquet', 'df_15.parquet', 'df_13.parquet', 'df_29.parquet']
Update 1 cells: ['df_25.parquet', 'df_11.parquet', 'df_05.parquet', 'df_19.parquet', 'df_07.parquet']
Update 2 cells: ['df_09.parquet', 'df_23.parquet', 'df_01.parquet', 'df_03.parquet', 'df_21.parquet']

Base training data shape: (45149, 8)
Update 1 data shape: (105846, 8)
Update 2 data shape: (112826, 8)
Test data shape: (22872, 8)

Features scaled using StandardScaler fitted on base training data.

Base - Training cells: ['29', '27', '13']
Base - Validation cells: ['15']
Update1 - Training cells: ['07', '05', '25', '19']
Update1 - Validation cells: ['11']
Update2 - Training cells: ['21', '01', '09', '03']
Update2 - Validation cells: ['23']
================================================================================
Method: Progressive Neural Networks (PNN)
================================================================================

Training base column...
Epoch 1/100 | Train Loss: 8.061e-02 | Val Loss: 1.270e-02 | LR: 1.00e-04
Epoch 2/100 | Train Loss: 2.428e-02 | Val Loss: 1.207e-02 | LR: 1.00e-04
Epoch 3/100 | Train Loss: 1.837e-02 | Val Loss: 4.836e-03 | LR: 1.00e-04
Epoch 4/100 | Train Loss: 1.228e-02 | Val Loss: 1.301e-02 | LR: 1.00e-04
Epoch 5/100 | Train Loss: 1.301e-02 | Val Loss: 1.071e-02 | LR: 1.00e-04
Epoch 6/100 | Train Loss: 9.688e-03 | Val Loss: 8.822e-03 | LR: 1.00e-04
Epoch 7/100 | Train Loss: 8.768e-03 | Val Loss: 6.447e-03 | LR: 1.00e-04
Epoch 8/100 | Train Loss: 8.623e-03 | Val Loss: 5.487e-03 | LR: 1.00e-04
Epoch 9/100 | Train Loss: 7.229e-03 | Val Loss: 5.681e-03 | LR: 5.00e-05
Epoch 10/100 | Train Loss: 6.250e-03 | Val Loss: 6.400e-03 | LR: 5.00e-05
Epoch 11/100 | Train Loss: 5.878e-03 | Val Loss: 1.157e-02 | LR: 5.00e-05
Epoch 12/100 | Train Loss: 5.347e-03 | Val Loss: 1.217e-02 | LR: 5.00e-05
Epoch 13/100 | Train Loss: 5.147e-03 | Val Loss: 6.491e-03 | LR: 5.00e-05
Early stopping triggered after 13 epochs!

Evaluating base model...
Base model metrics: {'RMSE': 0.017109832, 'MAE': 0.014712715, 'MAPE': 1.5291831456124783, 'R²': -0.0513308048248291}

Adding column for first update...
New column added at index 1
Training column for first update...
Epoch 1/50 | Train Loss: 3.137e-02 | Val Loss: 2.602e-03 | LR: 1.00e-04
Epoch 2/50 | Train Loss: 1.197e-02 | Val Loss: 5.301e-03 | LR: 1.00e-04
Epoch 3/50 | Train Loss: 8.650e-03 | Val Loss: 2.624e-03 | LR: 1.00e-04
Epoch 4/50 | Train Loss: 6.278e-03 | Val Loss: 3.068e-03 | LR: 1.00e-04
Epoch 5/50 | Train Loss: 4.948e-03 | Val Loss: 2.837e-03 | LR: 1.00e-04
Epoch 6/50 | Train Loss: 3.851e-03 | Val Loss: 2.551e-03 | LR: 1.00e-04
Epoch 7/50 | Train Loss: 3.069e-03 | Val Loss: 2.584e-03 | LR: 1.00e-04
Epoch 8/50 | Train Loss: 2.524e-03 | Val Loss: 2.361e-03 | LR: 1.00e-04
Epoch 9/50 | Train Loss: 2.145e-03 | Val Loss: 2.538e-03 | LR: 1.00e-04
Epoch 10/50 | Train Loss: 1.683e-03 | Val Loss: 2.146e-03 | LR: 1.00e-04
Epoch 11/50 | Train Loss: 1.477e-03 | Val Loss: 2.166e-03 | LR: 1.00e-04
Epoch 12/50 | Train Loss: 1.296e-03 | Val Loss: 2.704e-03 | LR: 1.00e-04
Epoch 13/50 | Train Loss: 1.285e-03 | Val Loss: 1.229e-02 | LR: 1.00e-04
Epoch 14/50 | Train Loss: 1.157e-03 | Val Loss: 1.418e-02 | LR: 1.00e-04
Epoch 15/50 | Train Loss: 9.910e-04 | Val Loss: 1.078e-02 | LR: 1.00e-04
Epoch 16/50 | Train Loss: 8.554e-04 | Val Loss: 7.153e-03 | LR: 5.00e-05
Epoch 17/50 | Train Loss: 7.852e-04 | Val Loss: 5.336e-03 | LR: 5.00e-05
Epoch 18/50 | Train Loss: 7.653e-04 | Val Loss: 8.267e-03 | LR: 5.00e-05
Epoch 19/50 | Train Loss: 7.431e-04 | Val Loss: 5.670e-03 | LR: 5.00e-05
Epoch 20/50 | Train Loss: 6.769e-04 | Val Loss: 5.606e-03 | LR: 5.00e-05
Early stopping triggered after 20 epochs!

Evaluating after first update...
Update 1 metrics: {'RMSE': 0.03052421, 'MAE': 0.026125133, 'MAPE': 2.9831798747181892, 'R²': -0.2649717330932617}

Adding column for second update...
New column added at index 2
Training column for second update...
Epoch 1/50 | Train Loss: 3.100e-02 | Val Loss: 1.606e-03 | LR: 1.00e-04
Epoch 2/50 | Train Loss: 1.114e-02 | Val Loss: 1.967e-03 | LR: 1.00e-04
Epoch 3/50 | Train Loss: 8.449e-03 | Val Loss: 2.057e-03 | LR: 1.00e-04
Epoch 4/50 | Train Loss: 6.923e-03 | Val Loss: 1.812e-03 | LR: 1.00e-04
Epoch 5/50 | Train Loss: 5.849e-03 | Val Loss: 1.905e-03 | LR: 1.00e-04
Epoch 6/50 | Train Loss: 5.005e-03 | Val Loss: 1.704e-03 | LR: 1.00e-04
Epoch 7/50 | Train Loss: 4.121e-03 | Val Loss: 1.502e-03 | LR: 1.00e-04
Epoch 8/50 | Train Loss: 3.459e-03 | Val Loss: 2.439e-03 | LR: 1.00e-04
Epoch 9/50 | Train Loss: 1.519e-03 | Val Loss: 1.778e-03 | LR: 1.00e-04
Epoch 10/50 | Train Loss: 1.187e-03 | Val Loss: 1.939e-03 | LR: 1.00e-04
Epoch 11/50 | Train Loss: 1.113e-03 | Val Loss: 1.794e-03 | LR: 1.00e-04
Epoch 12/50 | Train Loss: 1.072e-03 | Val Loss: 1.753e-03 | LR: 1.00e-04
Epoch 13/50 | Train Loss: 9.403e-04 | Val Loss: 1.965e-03 | LR: 5.00e-05
Epoch 14/50 | Train Loss: 7.350e-04 | Val Loss: 1.504e-03 | LR: 5.00e-05
Epoch 15/50 | Train Loss: 7.055e-04 | Val Loss: 1.720e-03 | LR: 5.00e-05
Epoch 16/50 | Train Loss: 6.803e-04 | Val Loss: 1.600e-03 | LR: 5.00e-05
Epoch 17/50 | Train Loss: 6.467e-04 | Val Loss: 1.630e-03 | LR: 5.00e-05
Early stopping triggered after 17 epochs!

Evaluating after second update...
Update 2 metrics: {'RMSE': 0.1076194, 'MAE': 0.09803655, 'MAPE': 13.000687956809998, 'R²': -7.47292423248291}
Results saved to /beegfs/home/users/z/zzhuqshun/Thesis/04_NNs/models/incremental_learning_20250404_185603/results
PNN Incremental Learning Finished!

All Done.
