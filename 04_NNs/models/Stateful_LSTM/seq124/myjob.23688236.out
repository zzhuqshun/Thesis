Using device: cuda:0

Degradation categories and rates:
    cell_id      rate category
0       01  0.000391   normal
1       03  0.000518   normal
2       05  0.000499   normal
3       07  0.000750   normal
4       09  0.003106   faster
5       11  0.003046   faster
6       13  0.008297   faster
7       15  0.006153   faster
8       17  0.001771     fast
9       19  0.001001     fast
10      21  0.001098     fast
11      23  0.000973     fast
12      25  0.002719     fast
13      27  0.000463   normal
14      29  0.006876   faster 

Train IDs: ['03', '05', '07', '09', '11', '15', '21', '23', '25', '27', '29'], Val IDs: ['01', '19', '13'], Test IDs: ['17']
Shapes -> Train: (205444, 7), Val: (58110, 7), Test: (22846, 7)

Features scaled with StandardScaler
Model architecture:
StatefulSOHLSTM(
  (lstm): LSTM(3, 32, num_layers=3, batch_first=True, dropout=0.2)
  (fc_layers): Sequential(
    (0): Linear(in_features=32, out_features=16, bias=True)
    (1): LeakyReLU(negative_slope=0.01)
    (2): Dropout(p=0.2, inplace=False)
    (3): Linear(in_features=16, out_features=1, bias=True)
  )
)
Total parameters: 22177

Start training with stateful LSTM...
Epoch 1/200 | Training Loss: 7.201e-02 | Validation Loss: 2.938e-03 
Epoch 2/200 | Training Loss: 2.269e-02 | Validation Loss: 2.994e-03 
Epoch 3/200 | Training Loss: 1.600e-02 | Validation Loss: 2.901e-03 
Epoch 4/200 | Training Loss: 1.172e-02 | Validation Loss: 3.110e-03 
Epoch 5/200 | Training Loss: 9.412e-03 | Validation Loss: 2.626e-03 
Epoch 6/200 | Training Loss: 7.859e-03 | Validation Loss: 2.824e-03 
Epoch 7/200 | Training Loss: 6.769e-03 | Validation Loss: 2.300e-03 
Epoch 8/200 | Training Loss: 5.833e-03 | Validation Loss: 2.146e-03 
Epoch 9/200 | Training Loss: 5.007e-03 | Validation Loss: 1.731e-03 
Epoch 10/200 | Training Loss: 4.306e-03 | Validation Loss: 1.350e-03 
Epoch 11/200 | Training Loss: 3.801e-03 | Validation Loss: 1.618e-03 
Epoch 12/200 | Training Loss: 3.373e-03 | Validation Loss: 1.645e-03 
Epoch 13/200 | Training Loss: 3.052e-03 | Validation Loss: 1.339e-03 
Epoch 14/200 | Training Loss: 2.777e-03 | Validation Loss: 1.247e-03 
Epoch 15/200 | Training Loss: 2.580e-03 | Validation Loss: 1.235e-03 
Epoch 16/200 | Training Loss: 2.405e-03 | Validation Loss: 1.207e-03 
Epoch 17/200 | Training Loss: 2.282e-03 | Validation Loss: 1.231e-03 
Epoch 18/200 | Training Loss: 2.161e-03 | Validation Loss: 1.203e-03 
Epoch 19/200 | Training Loss: 2.055e-03 | Validation Loss: 1.179e-03 
Epoch 20/200 | Training Loss: 1.961e-03 | Validation Loss: 1.246e-03 
Epoch 21/200 | Training Loss: 1.885e-03 | Validation Loss: 1.182e-03 
Epoch 22/200 | Training Loss: 1.829e-03 | Validation Loss: 1.210e-03 
Epoch 23/200 | Training Loss: 1.775e-03 | Validation Loss: 1.330e-03 
Epoch 24/200 | Training Loss: 1.730e-03 | Validation Loss: 1.211e-03 
Epoch 25/200 | Training Loss: 1.692e-03 | Validation Loss: 1.267e-03 
Epoch 26/200 | Training Loss: 1.550e-03 | Validation Loss: 9.994e-04 
Epoch 27/200 | Training Loss: 1.502e-03 | Validation Loss: 1.008e-03 
Epoch 28/200 | Training Loss: 1.474e-03 | Validation Loss: 9.985e-04 
Epoch 29/200 | Training Loss: 1.447e-03 | Validation Loss: 9.782e-04 
Epoch 30/200 | Training Loss: 1.423e-03 | Validation Loss: 9.905e-04 
Epoch 31/200 | Training Loss: 1.409e-03 | Validation Loss: 9.517e-04 
Epoch 32/200 | Training Loss: 1.385e-03 | Validation Loss: 9.611e-04 
Epoch 33/200 | Training Loss: 1.361e-03 | Validation Loss: 9.493e-04 
Epoch 34/200 | Training Loss: 1.338e-03 | Validation Loss: 9.150e-04 
Epoch 35/200 | Training Loss: 1.313e-03 | Validation Loss: 9.020e-04 
Epoch 36/200 | Training Loss: 1.295e-03 | Validation Loss: 8.872e-04 
Epoch 37/200 | Training Loss: 1.280e-03 | Validation Loss: 8.938e-04 
Epoch 38/200 | Training Loss: 1.261e-03 | Validation Loss: 8.800e-04 
Epoch 39/200 | Training Loss: 1.244e-03 | Validation Loss: 8.572e-04 
Epoch 40/200 | Training Loss: 1.222e-03 | Validation Loss: 8.455e-04 
Epoch 41/200 | Training Loss: 1.203e-03 | Validation Loss: 8.182e-04 
Epoch 42/200 | Training Loss: 1.191e-03 | Validation Loss: 8.100e-04 
Epoch 43/200 | Training Loss: 1.167e-03 | Validation Loss: 7.691e-04 
Epoch 44/200 | Training Loss: 1.132e-03 | Validation Loss: 7.558e-04 
Epoch 45/200 | Training Loss: 1.101e-03 | Validation Loss: 7.390e-04 
Epoch 46/200 | Training Loss: 1.074e-03 | Validation Loss: 7.209e-04 
Epoch 47/200 | Training Loss: 1.047e-03 | Validation Loss: 7.090e-04 
Epoch 48/200 | Training Loss: 1.041e-03 | Validation Loss: 7.297e-04 
Epoch 49/200 | Training Loss: 1.017e-03 | Validation Loss: 6.969e-04 
Epoch 50/200 | Training Loss: 9.986e-04 | Validation Loss: 7.080e-04 
Epoch 51/200 | Training Loss: 9.837e-04 | Validation Loss: 7.191e-04 
Epoch 52/200 | Training Loss: 9.672e-04 | Validation Loss: 7.051e-04 
Epoch 53/200 | Training Loss: 9.592e-04 | Validation Loss: 7.304e-04 
Epoch 54/200 | Training Loss: 9.478e-04 | Validation Loss: 7.445e-04 
Epoch 55/200 | Training Loss: 9.298e-04 | Validation Loss: 7.395e-04 
Epoch 56/200 | Training Loss: 8.807e-04 | Validation Loss: 6.582e-04 
Epoch 57/200 | Training Loss: 8.665e-04 | Validation Loss: 6.694e-04 
Epoch 58/200 | Training Loss: 8.584e-04 | Validation Loss: 6.579e-04 
Epoch 59/200 | Training Loss: 8.533e-04 | Validation Loss: 6.600e-04 
Epoch 60/200 | Training Loss: 8.492e-04 | Validation Loss: 6.557e-04 
Epoch 61/200 | Training Loss: 8.355e-04 | Validation Loss: 6.452e-04 
Epoch 62/200 | Training Loss: 8.244e-04 | Validation Loss: 6.571e-04 
Epoch 63/200 | Training Loss: 8.172e-04 | Validation Loss: 6.433e-04 
Epoch 64/200 | Training Loss: 8.033e-04 | Validation Loss: 6.684e-04 
Epoch 65/200 | Training Loss: 7.985e-04 | Validation Loss: 6.645e-04 
Epoch 66/200 | Training Loss: 7.937e-04 | Validation Loss: 6.535e-04 
Epoch 67/200 | Training Loss: 7.885e-04 | Validation Loss: 6.636e-04 
Epoch 68/200 | Training Loss: 7.839e-04 | Validation Loss: 6.579e-04 
Epoch 69/200 | Training Loss: 7.709e-04 | Validation Loss: 6.686e-04 
Epoch 70/200 | Training Loss: 7.489e-04 | Validation Loss: 6.218e-04 
Epoch 71/200 | Training Loss: 7.422e-04 | Validation Loss: 6.199e-04 
Epoch 72/200 | Training Loss: 7.388e-04 | Validation Loss: 6.173e-04 
Epoch 73/200 | Training Loss: 7.343e-04 | Validation Loss: 6.164e-04 
Epoch 74/200 | Training Loss: 7.220e-04 | Validation Loss: 6.138e-04 
Epoch 75/200 | Training Loss: 7.213e-04 | Validation Loss: 6.131e-04 
Epoch 76/200 | Training Loss: 7.164e-04 | Validation Loss: 6.196e-04 
Epoch 77/200 | Training Loss: 7.094e-04 | Validation Loss: 6.162e-04 
Epoch 78/200 | Training Loss: 7.056e-04 | Validation Loss: 6.156e-04 
Epoch 79/200 | Training Loss: 6.985e-04 | Validation Loss: 6.184e-04 
Epoch 80/200 | Training Loss: 6.997e-04 | Validation Loss: 6.138e-04 
Epoch 81/200 | Training Loss: 6.939e-04 | Validation Loss: 6.090e-04 
Epoch 82/200 | Training Loss: 6.913e-04 | Validation Loss: 6.196e-04 
Epoch 83/200 | Training Loss: 6.874e-04 | Validation Loss: 6.143e-04 
Epoch 84/200 | Training Loss: 6.856e-04 | Validation Loss: 6.181e-04 
Epoch 85/200 | Training Loss: 6.826e-04 | Validation Loss: 6.096e-04 
Epoch 86/200 | Training Loss: 6.773e-04 | Validation Loss: 6.138e-04 
Epoch 87/200 | Training Loss: 6.784e-04 | Validation Loss: 6.207e-04 
Epoch 88/200 | Training Loss: 6.617e-04 | Validation Loss: 6.142e-04 
Epoch 89/200 | Training Loss: 6.612e-04 | Validation Loss: 6.096e-04 
Epoch 90/200 | Training Loss: 6.583e-04 | Validation Loss: 6.133e-04 
Epoch 91/200 | Training Loss: 6.540e-04 | Validation Loss: 6.097e-04 
Epoch 92/200 | Training Loss: 6.556e-04 | Validation Loss: 6.124e-04 
Epoch 93/200 | Training Loss: 6.531e-04 | Validation Loss: 6.140e-04 
Epoch 94/200 | Training Loss: 6.479e-04 | Validation Loss: 6.164e-04 
Epoch 95/200 | Training Loss: 6.458e-04 | Validation Loss: 6.154e-04 
Epoch 96/200 | Training Loss: 6.455e-04 | Validation Loss: 6.164e-04 
Epoch 97/200 | Training Loss: 6.410e-04 | Validation Loss: 6.144e-04 
Epoch 98/200 | Training Loss: 6.399e-04 | Validation Loss: 6.147e-04 
Epoch 99/200 | Training Loss: 6.403e-04 | Validation Loss: 6.130e-04 
Epoch 100/200 | Training Loss: 6.377e-04 | Validation Loss: 6.171e-04 
Epoch 101/200 | Training Loss: 6.406e-04 | Validation Loss: 6.155e-04 
Early stopping triggered after 101 epochs!

Evaluating the model on the testing set...
Evaluating cell_id: 17
Evaluation metrics for cell 17:
  RMSE: 0.0224
  MAE: 0.0164
  R²: 0.9311
RMSE: 0.0224
MAE: 0.0164
R²: 0.9311
Prediction plot saved for cell 17
Prediction scatter plot saved for cell 17
