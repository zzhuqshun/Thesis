2025-08-03 13:48:55,832 - ==== Experiment Setup ====
2025-08-03 13:48:55,834 - Mode: incremental
2025-08-03 13:48:55,837 - Number of tasks: 3
2025-08-03 13:48:55,838 - Random seed: 42
2025-08-03 13:48:55,840 - Base directory: /beegfs/home/users/z/zzhuqshun/Thesis/06_adapter/fine_tuning
2025-08-03 13:48:55,841 - ==== Incremental Training (Pure Fine-tuning) ====
2025-08-03 13:48:55,975 - Number of tasks: 3
2025-08-03 13:50:33,705 - Incremental training - Task 0 Train IDs: ['03', '27', '05', '21', '11'], size: 107395
2025-08-03 13:50:33,710 - Incremental training - Task 0 Val IDs: ['01'], size: 20028
2025-08-03 13:50:33,713 - Incremental training - Test Task 0 size: 8584
2025-08-03 13:50:33,716 - Incremental training - Task 1 Train IDs: ['09', '29', '25'], size: 41175
2025-08-03 13:50:33,721 - Incremental training - Task 1 Val IDs: ['19'], size: 16183
2025-08-03 13:50:33,728 - Incremental training - Test Task 1 size: 6937
2025-08-03 13:50:33,733 - Incremental training - Task 2 Train IDs: ['15', '07', '23'], size: 57074
2025-08-03 13:50:33,738 - Incremental training - Task 2 Val IDs: ['13'], size: 4511
2025-08-03 13:50:33,743 - Incremental training - Test Task 2 size: 1934
2025-08-03 13:50:33,761 -   (Scaler) Scaler centers: [ 3.3374245   0.101279   27.50083333]
2025-08-03 13:50:33,772 -   (Scaler) Scaler scales: [0.18253608 1.77971742 1.05683333]
2025-08-03 13:50:34,728 - --- task0 ---
2025-08-03 13:55:15,981 - Epoch 0 train=3.4183e-02 val=1.8106e-03 lr=1.00e-04 time=103.40s
2025-08-03 13:57:02,272 - Epoch 1 train=7.4524e-03 val=9.6827e-04 lr=1.00e-04 time=100.61s
2025-08-03 13:58:49,434 - Epoch 2 train=5.6415e-03 val=1.1449e-03 lr=1.00e-04 time=101.00s
2025-08-03 14:00:35,423 - Epoch 3 train=4.6389e-03 val=5.0094e-04 lr=1.00e-04 time=100.44s
2025-08-03 14:02:21,623 - Epoch 4 train=3.7085e-03 val=1.0208e-03 lr=1.00e-04 time=100.61s
2025-08-03 14:04:07,453 - Epoch 5 train=2.8454e-03 val=3.8385e-04 lr=1.00e-04 time=100.28s
2025-08-03 14:05:52,823 - Epoch 6 train=1.9421e-03 val=3.4660e-04 lr=1.00e-04 time=99.77s
2025-08-03 14:07:37,699 - Epoch 7 train=1.3745e-03 val=2.3536e-04 lr=1.00e-04 time=99.28s
2025-08-03 14:09:22,511 - Epoch 8 train=1.1364e-03 val=2.8731e-04 lr=1.00e-04 time=99.22s
2025-08-03 14:11:20,399 - Epoch 9 train=8.5875e-04 val=9.2570e-04 lr=1.00e-04 time=112.33s
2025-08-03 14:13:24,125 - Epoch 10 train=6.4584e-04 val=9.1032e-04 lr=1.00e-04 time=117.81s
2025-08-03 14:15:11,010 - Epoch 11 train=5.3215e-04 val=1.2565e-03 lr=1.00e-04 time=101.29s
2025-08-03 14:16:55,693 - Epoch 12 train=4.7213e-04 val=8.5282e-03 lr=1.00e-04 time=99.12s
2025-08-03 14:18:40,371 - Epoch 13 train=4.5206e-04 val=2.6870e-03 lr=1.00e-04 time=99.13s
2025-08-03 14:20:23,953 - Epoch 14 train=3.1625e-04 val=1.1495e-02 lr=5.00e-05 time=98.00s
2025-08-03 14:22:07,854 - Epoch 15 train=2.0442e-04 val=1.1450e-02 lr=5.00e-05 time=98.30s
2025-08-03 14:23:56,389 - Epoch 16 train=2.8454e-04 val=5.0561e-03 lr=5.00e-05 time=102.95s
2025-08-03 14:25:39,510 - Epoch 17 train=4.2232e-04 val=7.1749e-03 lr=5.00e-05 time=97.54s
2025-08-03 14:27:25,609 - Epoch 18 train=2.4178e-04 val=7.7412e-03 lr=5.00e-05 time=100.52s
2025-08-03 14:29:08,252 - Epoch 19 train=1.7374e-04 val=8.2510e-03 lr=5.00e-05 time=97.07s
2025-08-03 14:30:49,413 - Epoch 20 train=1.1908e-04 val=7.0348e-03 lr=2.50e-05 time=95.56s
2025-08-03 14:32:30,738 - Epoch 21 train=1.0881e-04 val=4.9684e-03 lr=2.50e-05 time=95.74s
2025-08-03 14:34:11,617 - Epoch 22 train=9.9826e-05 val=5.4105e-03 lr=2.50e-05 time=95.28s
2025-08-03 14:35:52,160 - Epoch 23 train=9.6723e-05 val=4.8673e-03 lr=2.50e-05 time=94.96s
2025-08-03 14:37:32,693 - Epoch 24 train=9.0518e-05 val=4.2275e-03 lr=2.50e-05 time=94.95s
2025-08-03 14:39:12,937 - Epoch 25 train=8.6469e-05 val=8.7125e-03 lr=2.50e-05 time=94.66s
2025-08-03 14:40:52,347 - Epoch 26 train=8.0020e-05 val=4.1118e-03 lr=1.25e-05 time=93.83s
2025-08-03 14:42:35,286 - Epoch 27 train=7.8008e-05 val=4.4624e-03 lr=1.25e-05 time=97.36s
2025-08-03 14:42:35,289 - Early stopping at epoch 27
2025-08-03 14:42:40,206 - Task 0 completed.
2025-08-03 14:42:40,208 - --- task1 ---
2025-08-03 14:43:20,049 - Epoch 0 train=2.0958e-03 val=8.7926e-04 lr=1.00e-04 time=35.20s
2025-08-03 14:43:59,612 - Epoch 1 train=1.6442e-03 val=7.1954e-04 lr=1.00e-04 time=35.07s
2025-08-03 14:44:39,175 - Epoch 2 train=1.5009e-03 val=4.7417e-04 lr=1.00e-04 time=35.07s
2025-08-03 14:45:18,374 - Epoch 3 train=1.2994e-03 val=3.7329e-04 lr=1.00e-04 time=34.72s
2025-08-03 14:45:57,586 - Epoch 4 train=1.0590e-03 val=4.7772e-04 lr=1.00e-04 time=34.73s
2025-08-03 14:46:36,635 - Epoch 5 train=8.4249e-04 val=4.0576e-04 lr=1.00e-04 time=34.59s
2025-08-03 14:47:15,642 - Epoch 6 train=7.0588e-04 val=6.2500e-04 lr=1.00e-04 time=34.55s
2025-08-03 14:47:55,098 - Epoch 7 train=6.8628e-04 val=2.4323e-04 lr=1.00e-04 time=35.00s
2025-08-03 14:48:37,124 - Epoch 8 train=5.5688e-04 val=2.4353e-04 lr=1.00e-04 time=37.55s
2025-08-03 14:49:21,585 - Epoch 9 train=4.9624e-04 val=3.0656e-04 lr=1.00e-04 time=40.00s
2025-08-03 14:50:08,056 - Epoch 10 train=4.6589e-04 val=5.8967e-04 lr=1.00e-04 time=42.01s
2025-08-03 14:50:54,570 - Epoch 11 train=4.2230e-04 val=2.0482e-04 lr=1.00e-04 time=42.05s
2025-08-03 14:51:41,159 - Epoch 12 train=3.9808e-04 val=1.7507e-04 lr=1.00e-04 time=42.08s
2025-08-03 14:52:27,637 - Epoch 13 train=3.8329e-04 val=2.4895e-04 lr=1.00e-04 time=41.98s
2025-08-03 14:53:14,040 - Epoch 14 train=3.7674e-04 val=3.1296e-04 lr=1.00e-04 time=41.94s
2025-08-03 14:54:01,036 - Epoch 15 train=4.4213e-04 val=7.2634e-04 lr=1.00e-04 time=42.54s
2025-08-03 14:54:47,721 - Epoch 16 train=3.4531e-04 val=8.6469e-05 lr=1.00e-04 time=42.22s
2025-08-03 14:55:34,596 - Epoch 17 train=3.3336e-04 val=3.3549e-04 lr=1.00e-04 time=42.38s
2025-08-03 14:56:22,104 - Epoch 18 train=3.2019e-04 val=3.6287e-04 lr=1.00e-04 time=43.05s
2025-08-03 14:57:09,561 - Epoch 19 train=3.1644e-04 val=3.8994e-04 lr=1.00e-04 time=42.99s
2025-08-03 14:57:56,950 - Epoch 20 train=3.0246e-04 val=5.7178e-04 lr=1.00e-04 time=42.93s
2025-08-03 14:58:44,421 - Epoch 21 train=2.9928e-04 val=4.4575e-04 lr=1.00e-04 time=43.01s
2025-08-03 14:59:31,884 - Epoch 22 train=2.9358e-04 val=8.4612e-04 lr=1.00e-04 time=42.99s
2025-08-03 15:00:19,235 - Epoch 23 train=2.6107e-04 val=5.8152e-04 lr=5.00e-05 time=42.88s
2025-08-03 15:01:06,205 - Epoch 24 train=2.5857e-04 val=8.9328e-04 lr=5.00e-05 time=42.51s
2025-08-03 15:02:06,375 - Epoch 25 train=2.5899e-04 val=1.0855e-03 lr=5.00e-05 time=55.67s
2025-08-03 15:03:07,093 - Epoch 26 train=3.8520e-04 val=6.4272e-04 lr=5.00e-05 time=56.25s
2025-08-03 15:04:06,768 - Epoch 27 train=2.9010e-04 val=3.6897e-04 lr=5.00e-05 time=55.20s
2025-08-03 15:05:09,573 - Epoch 28 train=2.5311e-04 val=3.5261e-04 lr=5.00e-05 time=58.31s
2025-08-03 15:06:16,189 - Epoch 29 train=2.3926e-04 val=5.7172e-04 lr=2.50e-05 time=62.13s
2025-08-03 15:07:21,897 - Epoch 30 train=2.3323e-04 val=5.6165e-04 lr=2.50e-05 time=61.22s
2025-08-03 15:08:26,056 - Epoch 31 train=2.2948e-04 val=4.9250e-04 lr=2.50e-05 time=59.68s
2025-08-03 15:09:30,245 - Epoch 32 train=2.2485e-04 val=8.6014e-04 lr=2.50e-05 time=59.71s
2025-08-03 15:10:34,001 - Epoch 33 train=2.2526e-04 val=1.0945e-03 lr=2.50e-05 time=59.28s
2025-08-03 15:11:38,337 - Epoch 34 train=2.2881e-04 val=6.6243e-04 lr=2.50e-05 time=59.85s
2025-08-03 15:12:36,802 - Epoch 35 train=2.1315e-04 val=1.0783e-03 lr=1.25e-05 time=53.98s
2025-08-03 15:13:46,033 - Epoch 36 train=2.0796e-04 val=1.1810e-03 lr=1.25e-05 time=64.74s
2025-08-03 15:13:46,052 - Early stopping at epoch 36
2025-08-03 15:13:48,723 - Task 1 completed.
2025-08-03 15:13:48,739 - --- task2 ---
2025-08-03 15:15:13,880 - Epoch 0 train=3.7836e-04 val=1.6968e-03 lr=1.00e-04 time=83.63s
2025-08-03 15:16:39,653 - Epoch 1 train=3.0410e-04 val=7.8972e-04 lr=1.00e-04 time=84.49s
2025-08-03 15:17:48,638 - Epoch 2 train=2.6267e-04 val=1.6394e-03 lr=1.00e-04 time=67.72s
2025-08-03 15:18:50,465 - Epoch 3 train=2.3238e-04 val=3.4116e-04 lr=1.00e-04 time=60.71s
2025-08-03 15:19:55,887 - Epoch 4 train=2.1140e-04 val=3.7550e-04 lr=1.00e-04 time=64.25s
2025-08-03 15:21:18,271 - Epoch 5 train=1.8838e-04 val=5.0924e-04 lr=1.00e-04 time=81.25s
2025-08-03 15:22:29,099 - Epoch 6 train=1.7947e-04 val=1.2892e-04 lr=1.00e-04 time=69.71s
2025-08-03 15:23:30,591 - Epoch 7 train=1.5900e-04 val=1.5003e-04 lr=1.00e-04 time=60.32s
2025-08-03 15:24:32,493 - Epoch 8 train=1.5231e-04 val=1.3080e-04 lr=1.00e-04 time=60.78s
2025-08-03 15:25:34,474 - Epoch 9 train=1.5190e-04 val=1.3191e-04 lr=1.00e-04 time=60.86s
2025-08-03 15:26:46,539 - Epoch 10 train=1.4212e-04 val=7.4036e-05 lr=1.00e-04 time=70.95s
2025-08-03 15:27:39,222 - Epoch 11 train=1.3523e-04 val=7.5248e-05 lr=1.00e-04 time=51.52s
2025-08-03 15:28:30,762 - Epoch 12 train=1.3811e-04 val=1.3510e-04 lr=1.00e-04 time=50.41s
2025-08-03 15:29:20,231 - Epoch 13 train=1.3514e-04 val=9.4746e-05 lr=1.00e-04 time=48.36s
2025-08-03 15:30:29,625 - Epoch 14 train=1.2569e-04 val=8.3051e-05 lr=1.00e-04 time=68.29s
2025-08-03 15:31:20,832 - Epoch 15 train=1.2005e-04 val=9.9063e-05 lr=1.00e-04 time=50.10s
2025-08-03 15:32:07,721 - Epoch 16 train=1.1912e-04 val=1.0385e-04 lr=1.00e-04 time=45.78s
2025-08-03 15:32:54,376 - Epoch 17 train=9.7428e-05 val=7.0703e-05 lr=5.00e-05 time=45.55s
2025-08-03 15:33:43,774 - Epoch 18 train=9.5338e-05 val=9.6350e-05 lr=5.00e-05 time=48.27s
2025-08-03 15:34:44,351 - Epoch 19 train=9.1119e-05 val=8.1026e-05 lr=5.00e-05 time=59.47s
2025-08-03 15:35:44,843 - Epoch 20 train=9.2978e-05 val=6.2966e-05 lr=5.00e-05 time=59.38s
2025-08-03 15:36:42,908 - Epoch 21 train=9.3443e-05 val=1.4120e-04 lr=5.00e-05 time=56.94s
2025-08-03 15:37:31,919 - Epoch 22 train=8.9044e-05 val=1.3385e-04 lr=5.00e-05 time=47.90s
2025-08-03 15:38:20,841 - Epoch 23 train=8.7336e-05 val=8.9756e-05 lr=5.00e-05 time=47.81s
2025-08-03 15:39:09,819 - Epoch 24 train=8.9005e-05 val=8.7444e-05 lr=5.00e-05 time=47.87s
2025-08-03 15:39:58,598 - Epoch 25 train=9.0102e-05 val=2.6603e-04 lr=5.00e-05 time=47.67s
2025-08-03 15:40:47,669 - Epoch 26 train=8.5150e-05 val=1.1926e-04 lr=5.00e-05 time=47.96s
2025-08-03 15:41:36,740 - Epoch 27 train=7.7464e-05 val=1.3393e-04 lr=2.50e-05 time=47.96s
2025-08-03 15:42:25,618 - Epoch 28 train=7.4247e-05 val=1.1922e-04 lr=2.50e-05 time=47.77s
2025-08-03 15:43:14,320 - Epoch 29 train=7.5550e-05 val=1.8427e-04 lr=2.50e-05 time=47.59s
2025-08-03 15:44:03,358 - Epoch 30 train=7.3963e-05 val=8.1673e-05 lr=2.50e-05 time=47.90s
2025-08-03 15:44:52,212 - Epoch 31 train=7.2932e-05 val=1.7898e-04 lr=2.50e-05 time=47.74s
2025-08-03 15:45:40,998 - Epoch 32 train=7.2363e-05 val=1.2205e-04 lr=2.50e-05 time=47.66s
2025-08-03 15:46:29,858 - Epoch 33 train=6.7589e-05 val=1.2012e-04 lr=1.25e-05 time=47.75s
2025-08-03 15:47:18,690 - Epoch 34 train=6.9245e-05 val=1.6200e-04 lr=1.25e-05 time=47.72s
2025-08-03 15:48:10,840 - Epoch 35 train=6.7961e-05 val=1.0715e-04 lr=1.25e-05 time=51.04s
2025-08-03 15:48:59,855 - Epoch 36 train=6.7602e-05 val=9.7284e-05 lr=1.25e-05 time=47.90s
2025-08-03 15:49:48,689 - Epoch 37 train=6.8653e-05 val=1.3408e-04 lr=1.25e-05 time=47.72s
2025-08-03 15:50:41,663 - Epoch 38 train=6.6043e-05 val=1.0811e-04 lr=1.25e-05 time=51.86s
2025-08-03 15:51:30,844 - Epoch 39 train=6.8602e-05 val=1.4521e-04 lr=6.25e-06 time=48.07s
2025-08-03 15:52:19,909 - Epoch 40 train=6.5686e-05 val=1.2165e-04 lr=6.25e-06 time=47.95s
2025-08-03 15:52:19,911 - Early stopping at epoch 40
2025-08-03 15:52:22,134 - Task 2 completed.
2025-08-03 15:52:22,135 - ==== Incremental Training Complete ====
2025-08-03 15:52:22,136 - ==== Starting Comprehensive Evaluation ====
2025-08-03 15:52:22,199 - Evaluating model trained after task 0...
2025-08-03 15:52:34,335 -   Task 0 -> Test Task 0: MAE=2.7923e-02, R2=-29.2707
2025-08-03 15:52:36,132 -   Task 0 -> Test Task 1: MAE=3.5453e-02, R2=-2.1284
2025-08-03 15:52:36,489 -   Task 0 -> Test Task 2: MAE=7.2164e-01, R2=-980.0900
2025-08-03 15:52:36,490 - Evaluating model trained after task 1...
2025-08-03 15:52:48,492 -   Task 1 -> Test Task 0: MAE=3.5175e-02, R2=-49.1422
2025-08-03 15:52:50,279 -   Task 1 -> Test Task 1: MAE=1.2655e-02, R2=0.5757
2025-08-03 15:52:50,634 -   Task 1 -> Test Task 2: MAE=3.1547e-02, R2=-0.5866
2025-08-03 15:52:50,635 - Evaluating model trained after task 2...
2025-08-03 15:53:02,827 -   Task 2 -> Test Task 0: MAE=2.4834e-02, R2=-25.0796
2025-08-03 15:53:04,616 -   Task 2 -> Test Task 1: MAE=2.3275e-02, R2=-0.2577
2025-08-03 15:53:04,970 -   Task 2 -> Test Task 2: MAE=2.5186e-02, R2=-0.0489
2025-08-03 15:53:04,971 - ==== Computing Continual Learning Metrics ====
2025-08-03 15:53:04,972 - Computing random initialization baselines...
2025-08-03 15:53:07,238 -   Baseline Task 0: R=-0.9732
2025-08-03 15:53:09,007 -   Baseline Task 1: R=-0.9253
2025-08-03 15:53:09,356 -   Baseline Task 2: R=-0.6923
2025-08-03 15:53:09,359 - ==== Continual Learning Results ====
2025-08-03 15:53:09,362 - BWT (Backward Transfer): -0.0038 (less negative = less forgetting)
2025-08-03 15:53:09,365 - FWT (Forward Transfer): 0.7753 (positive = beneficial transfer)
2025-08-03 15:53:09,366 - ACC (Average Accuracy): -0.0244
2025-08-03 15:53:09,368 - ==== Performance Matrix R[i][j] ====
2025-08-03 15:53:09,369 - Rows: trained after task i, Columns: evaluated on task j
2025-08-03 15:53:09,370 -        Task 0 Task 1 Task 2
2025-08-03 15:53:09,373 - Task 0: -0.0279 -0.0355 -0.7216
2025-08-03 15:53:09,376 - Task 1: -0.0352 -0.0127 -0.0315
2025-08-03 15:53:09,377 - Task 2: -0.0248 -0.0233 -0.0252
2025-08-03 15:53:09,559 - ==== Evaluation Complete ====
2025-08-03 15:53:09,561 - All results saved to: /beegfs/home/users/z/zzhuqshun/Thesis/06_adapter/fine_tuning/incremental_training/metrics
2025-08-03 15:53:09,562 - ==== Final Summary ====
2025-08-03 15:53:09,563 - Continual Learning Metrics:
2025-08-03 15:53:09,564 -   BWT: -0.0038
2025-08-03 15:53:09,565 -   FWT: 0.7753
2025-08-03 15:53:09,566 -   ACC: -0.0244
2025-08-03 15:53:09,567 -   num_tasks: 3.0000
2025-08-03 15:53:09,568 - ==== Experiment Complete ====
