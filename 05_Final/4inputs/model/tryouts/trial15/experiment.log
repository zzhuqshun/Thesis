2025-07-16 21:19:28,098 - INFO - [EXPERIMENT] Directory: model/tryouts/trial15
2025-07-16 21:19:28,104 - INFO - [EXPERIMENT] Device: cuda
2025-07-16 21:19:28,109 - INFO - ============================================================
2025-07-16 21:19:28,113 - INFO - [JOINT] Starting Joint Training
2025-07-16 21:19:28,115 - INFO - ============================================================
2025-07-16 21:19:28,121 - INFO - [DATA] Mode: JOINT
2025-07-16 21:19:28,124 - INFO - [DATA] Resample rate: 10min
2025-07-16 21:19:28,129 - INFO -   (Split) Train IDs: ['03', '05', '07', '09', '11', '15', '21', '23', '25', '27', '29']
2025-07-16 21:19:28,133 - INFO -   (Split) Val IDs: ['01', '19', '13']
2025-07-16 21:20:44,908 - INFO -   (Split) joint_train: 205644 samples
2025-07-16 21:21:06,194 - INFO -   (Split) joint_val: 58177 samples
2025-07-16 21:21:14,075 - INFO -   (Split) joint_test_full: 22872 samples
2025-07-16 21:21:14,084 - INFO - [DATA] Fitting scaler: RobustScaler
2025-07-16 21:21:14,113 - INFO -   (Scaler) Features scaled: ['Voltage[V]', 'Current[A]', 'Temperature[Â°C]', 'EFC']
2025-07-16 21:21:14,116 - INFO -   (Scaler) Scaler centers: [3.34242200e+00 1.79929667e-01 2.77500000e+01 1.12265273e+03]
2025-07-16 21:21:14,128 - INFO -   (Scaler) Scaler scales: [1.84283625e-01 1.77955483e+00 1.81783333e+00 1.12257504e+03]
2025-07-16 21:21:14,154 - INFO - [DATA] Preparation complete. Keys: ['joint_train', 'joint_val', 'test_full']
2025-07-16 21:21:14,166 - INFO - [DATA] Grouping datasets by cell_id: True
2025-07-16 21:21:20,224 - INFO - [DATA] Created dataset with 197658 samples
2025-07-16 21:21:21,831 - INFO - [DATA] Created dataset with 55999 samples
2025-07-16 21:21:22,375 - INFO - [DATA] Created dataset with 22146 samples
2025-07-16 21:21:22,385 - INFO -   (DATA) Dataloaders created for: ['joint_train', 'joint_val', 'test_full']
2025-07-16 21:21:22,565 - INFO -   (MODEL) SOHLSTM initialized: input_size=4, hidden=32, layers=4, dropout=0.40
2025-07-16 21:21:24,000 - INFO -   (TRAIN) Start training on joint dataset ...
2025-07-16 21:26:46,281 - INFO - [TRAIN] Epoch 0: Train Loss: 4.2106e-02, Val Loss: 3.3053e-03, Task: 4.2106e-02, KD: 0.0000e+00, EWC: 0.0000e+00, LR: 1.000000e-04
2025-07-16 21:29:04,139 - INFO - [TRAIN] Epoch 1: Train Loss: 7.5176e-03, Val Loss: 2.5325e-03, Task: 7.5176e-03, KD: 0.0000e+00, EWC: 0.0000e+00, LR: 1.000000e-04
2025-07-16 21:31:18,191 - INFO - [TRAIN] Epoch 2: Train Loss: 1.9439e-03, Val Loss: 1.4554e-03, Task: 1.9439e-03, KD: 0.0000e+00, EWC: 0.0000e+00, LR: 1.000000e-04
2025-07-16 21:33:30,546 - INFO - [TRAIN] Epoch 3: Train Loss: 1.2189e-03, Val Loss: 1.2924e-03, Task: 1.2189e-03, KD: 0.0000e+00, EWC: 0.0000e+00, LR: 1.000000e-04
2025-07-16 21:35:40,599 - INFO - [TRAIN] Epoch 4: Train Loss: 1.0079e-03, Val Loss: 1.5114e-03, Task: 1.0079e-03, KD: 0.0000e+00, EWC: 0.0000e+00, LR: 1.000000e-04
2025-07-16 21:37:57,943 - INFO - [TRAIN] Epoch 5: Train Loss: 9.4260e-04, Val Loss: 1.2834e-03, Task: 9.4260e-04, KD: 0.0000e+00, EWC: 0.0000e+00, LR: 1.000000e-04
2025-07-16 21:40:15,395 - INFO - [TRAIN] Epoch 6: Train Loss: 8.7924e-04, Val Loss: 7.7430e-04, Task: 8.7924e-04, KD: 0.0000e+00, EWC: 0.0000e+00, LR: 1.000000e-04
2025-07-16 21:42:32,625 - INFO - [TRAIN] Epoch 7: Train Loss: 8.5496e-04, Val Loss: 1.1298e-03, Task: 8.5496e-04, KD: 0.0000e+00, EWC: 0.0000e+00, LR: 1.000000e-04
2025-07-16 21:44:50,240 - INFO - [TRAIN] Epoch 8: Train Loss: 8.4695e-04, Val Loss: 1.2540e-03, Task: 8.4695e-04, KD: 0.0000e+00, EWC: 0.0000e+00, LR: 1.000000e-04
2025-07-16 21:47:07,984 - INFO - [TRAIN] Epoch 9: Train Loss: 8.3922e-04, Val Loss: 1.0918e-03, Task: 8.3922e-04, KD: 0.0000e+00, EWC: 0.0000e+00, LR: 1.000000e-04
2025-07-16 21:49:25,333 - INFO - [TRAIN] Epoch 10: Train Loss: 8.3073e-04, Val Loss: 7.2553e-04, Task: 8.3073e-04, KD: 0.0000e+00, EWC: 0.0000e+00, LR: 1.000000e-04
2025-07-16 21:51:42,267 - INFO - [TRAIN] Epoch 11: Train Loss: 8.2294e-04, Val Loss: 7.9791e-04, Task: 8.2294e-04, KD: 0.0000e+00, EWC: 0.0000e+00, LR: 1.000000e-04
2025-07-16 21:53:53,374 - INFO - [TRAIN] Epoch 12: Train Loss: 8.2382e-04, Val Loss: 2.1680e-03, Task: 8.2382e-04, KD: 0.0000e+00, EWC: 0.0000e+00, LR: 1.000000e-04
2025-07-16 21:56:00,233 - INFO - [TRAIN] Epoch 13: Train Loss: 8.2119e-04, Val Loss: 8.3298e-04, Task: 8.2119e-04, KD: 0.0000e+00, EWC: 0.0000e+00, LR: 1.000000e-04
2025-07-16 21:58:07,562 - INFO - [TRAIN] Epoch 14: Train Loss: 8.1487e-04, Val Loss: 1.2489e-03, Task: 8.1487e-04, KD: 0.0000e+00, EWC: 0.0000e+00, LR: 1.000000e-04
2025-07-16 22:00:19,263 - INFO - [TRAIN] Epoch 15: Train Loss: 7.9863e-04, Val Loss: 9.1597e-04, Task: 7.9863e-04, KD: 0.0000e+00, EWC: 0.0000e+00, LR: 1.000000e-04
2025-07-16 22:02:33,644 - INFO - [TRAIN] Epoch 16: Train Loss: 7.9434e-04, Val Loss: 1.2001e-03, Task: 7.9434e-04, KD: 0.0000e+00, EWC: 0.0000e+00, LR: 5.000000e-05
2025-07-16 22:04:50,145 - INFO - [TRAIN] Epoch 17: Train Loss: 7.5157e-04, Val Loss: 8.5284e-04, Task: 7.5157e-04, KD: 0.0000e+00, EWC: 0.0000e+00, LR: 5.000000e-05
2025-07-16 22:07:05,668 - INFO - [TRAIN] Epoch 18: Train Loss: 7.3779e-04, Val Loss: 7.9184e-04, Task: 7.3779e-04, KD: 0.0000e+00, EWC: 0.0000e+00, LR: 5.000000e-05
2025-07-16 22:09:10,465 - INFO - [TRAIN] Epoch 19: Train Loss: 7.2806e-04, Val Loss: 6.4115e-04, Task: 7.2806e-04, KD: 0.0000e+00, EWC: 0.0000e+00, LR: 5.000000e-05
2025-07-16 22:11:12,339 - INFO - [TRAIN] Epoch 20: Train Loss: 7.2553e-04, Val Loss: 9.9018e-04, Task: 7.2553e-04, KD: 0.0000e+00, EWC: 0.0000e+00, LR: 5.000000e-05
2025-07-16 22:13:15,851 - INFO - [TRAIN] Epoch 21: Train Loss: 7.2316e-04, Val Loss: 9.8332e-04, Task: 7.2316e-04, KD: 0.0000e+00, EWC: 0.0000e+00, LR: 5.000000e-05
2025-07-16 22:15:23,762 - INFO - [TRAIN] Epoch 22: Train Loss: 7.1377e-04, Val Loss: 7.5705e-04, Task: 7.1377e-04, KD: 0.0000e+00, EWC: 0.0000e+00, LR: 5.000000e-05
2025-07-16 22:17:25,679 - INFO - [TRAIN] Epoch 23: Train Loss: 7.1385e-04, Val Loss: 1.1760e-03, Task: 7.1385e-04, KD: 0.0000e+00, EWC: 0.0000e+00, LR: 5.000000e-05
2025-07-16 22:19:18,872 - INFO - [TRAIN] Epoch 24: Train Loss: 7.1594e-04, Val Loss: 8.5385e-04, Task: 7.1594e-04, KD: 0.0000e+00, EWC: 0.0000e+00, LR: 5.000000e-05
2025-07-16 22:21:06,621 - INFO - [TRAIN] Epoch 25: Train Loss: 7.2214e-04, Val Loss: 5.7553e-04, Task: 7.2214e-04, KD: 0.0000e+00, EWC: 0.0000e+00, LR: 5.000000e-05
2025-07-16 22:22:51,256 - INFO - [TRAIN] Epoch 26: Train Loss: 7.1501e-04, Val Loss: 1.0516e-03, Task: 7.1501e-04, KD: 0.0000e+00, EWC: 0.0000e+00, LR: 5.000000e-05
2025-07-16 22:24:44,382 - INFO - [TRAIN] Epoch 27: Train Loss: 7.1449e-04, Val Loss: 2.1570e-03, Task: 7.1449e-04, KD: 0.0000e+00, EWC: 0.0000e+00, LR: 5.000000e-05
2025-07-16 22:26:40,849 - INFO - [TRAIN] Epoch 28: Train Loss: 7.1237e-04, Val Loss: 9.8516e-04, Task: 7.1237e-04, KD: 0.0000e+00, EWC: 0.0000e+00, LR: 5.000000e-05
2025-07-16 22:28:43,756 - INFO - [TRAIN] Epoch 29: Train Loss: 7.0922e-04, Val Loss: 9.3869e-04, Task: 7.0922e-04, KD: 0.0000e+00, EWC: 0.0000e+00, LR: 5.000000e-05
2025-07-16 22:30:45,909 - INFO - [TRAIN] Epoch 30: Train Loss: 7.0649e-04, Val Loss: 8.3880e-04, Task: 7.0649e-04, KD: 0.0000e+00, EWC: 0.0000e+00, LR: 5.000000e-05
2025-07-16 22:32:48,822 - INFO - [TRAIN] Epoch 31: Train Loss: 7.0853e-04, Val Loss: 1.2162e-03, Task: 7.0853e-04, KD: 0.0000e+00, EWC: 0.0000e+00, LR: 2.500000e-05
2025-07-16 22:34:55,333 - INFO - [TRAIN] Epoch 32: Train Loss: 6.7710e-04, Val Loss: 1.0828e-03, Task: 6.7710e-04, KD: 0.0000e+00, EWC: 0.0000e+00, LR: 2.500000e-05
2025-07-16 22:37:04,882 - INFO - [TRAIN] Epoch 33: Train Loss: 6.7478e-04, Val Loss: 9.3041e-04, Task: 6.7478e-04, KD: 0.0000e+00, EWC: 0.0000e+00, LR: 2.500000e-05
2025-07-16 22:39:17,639 - INFO - [TRAIN] Epoch 34: Train Loss: 6.7903e-04, Val Loss: 1.0262e-03, Task: 6.7903e-04, KD: 0.0000e+00, EWC: 0.0000e+00, LR: 2.500000e-05
2025-07-16 22:41:20,161 - INFO - [TRAIN] Epoch 35: Train Loss: 6.7726e-04, Val Loss: 1.0687e-03, Task: 6.7726e-04, KD: 0.0000e+00, EWC: 0.0000e+00, LR: 2.500000e-05
2025-07-16 22:43:17,237 - INFO - [TRAIN] Epoch 36: Train Loss: 6.6890e-04, Val Loss: 9.3071e-04, Task: 6.6890e-04, KD: 0.0000e+00, EWC: 0.0000e+00, LR: 2.500000e-05
2025-07-16 22:45:15,337 - INFO - [TRAIN] Epoch 37: Train Loss: 6.6231e-04, Val Loss: 8.7475e-04, Task: 6.6231e-04, KD: 0.0000e+00, EWC: 0.0000e+00, LR: 1.250000e-05
2025-07-16 22:47:03,511 - INFO - [TRAIN] Epoch 38: Train Loss: 6.5070e-04, Val Loss: 1.3220e-03, Task: 6.5070e-04, KD: 0.0000e+00, EWC: 0.0000e+00, LR: 1.250000e-05
2025-07-16 22:48:55,219 - INFO - [TRAIN] Epoch 39: Train Loss: 6.5937e-04, Val Loss: 1.1097e-03, Task: 6.5937e-04, KD: 0.0000e+00, EWC: 0.0000e+00, LR: 1.250000e-05
2025-07-16 22:50:55,824 - INFO - [TRAIN] Epoch 40: Train Loss: 6.5281e-04, Val Loss: 8.2958e-04, Task: 6.5281e-04, KD: 0.0000e+00, EWC: 0.0000e+00, LR: 1.250000e-05
2025-07-16 22:53:01,884 - INFO - [TRAIN] Epoch 41: Train Loss: 6.5315e-04, Val Loss: 1.1948e-03, Task: 6.5315e-04, KD: 0.0000e+00, EWC: 0.0000e+00, LR: 1.250000e-05
2025-07-16 22:55:04,160 - INFO - [TRAIN] Epoch 42: Train Loss: 6.4443e-04, Val Loss: 8.8294e-04, Task: 6.4443e-04, KD: 0.0000e+00, EWC: 0.0000e+00, LR: 1.250000e-05
2025-07-16 22:57:07,055 - INFO - [TRAIN] Epoch 43: Train Loss: 6.4712e-04, Val Loss: 1.0477e-03, Task: 6.4712e-04, KD: 0.0000e+00, EWC: 0.0000e+00, LR: 6.250000e-06
2025-07-16 22:59:09,846 - INFO - [TRAIN] Epoch 44: Train Loss: 6.3789e-04, Val Loss: 1.0299e-03, Task: 6.3789e-04, KD: 0.0000e+00, EWC: 0.0000e+00, LR: 6.250000e-06
2025-07-16 23:01:13,234 - INFO - [TRAIN] Epoch 45: Train Loss: 6.3887e-04, Val Loss: 8.5149e-04, Task: 6.3887e-04, KD: 0.0000e+00, EWC: 0.0000e+00, LR: 6.250000e-06
2025-07-16 23:01:13,253 - INFO - [TRAIN] Early stopping at epoch 45
2025-07-16 23:01:18,919 - INFO -   (TRAIN) Finished. Loss curves saved: model/tryouts/trial15/joint_training/training_curves.png
2025-07-16 23:01:21,522 - INFO -   (EVAL) [Test] RMSE: 5.2141e-02, MAE: 3.4625e-02, R2: 0.6159
2025-07-16 23:01:23,731 - INFO -   (EVAL) Prediction plots saved: model/tryouts/trial15/joint_training/predictions
2025-07-16 23:01:23,785 - INFO -   (MODEL) Checkpoint saved: model/tryouts/trial15/joint_training/model.pt
2025-07-16 23:01:23,796 - INFO - ============================================================
2025-07-16 23:01:23,808 - INFO - [JOINT] Joint training finished.
2025-07-16 23:01:23,821 - INFO - ============================================================
2025-07-16 23:01:23,833 - INFO - [EXPERIMENT] Completed!
